{
  "metadata": {
    "title": "Linux System Programming Essentials",
    "author": "Michael Kerrisk",
    "source": "man7.org",
    "extractedAt": "2026-01-05T02:39:09.999Z",
    "totalPages": 129
  },
  "chapters": [
    {
      "number": 1,
      "title": "Course Introduction",
      "sections": []
    },
    {
      "number": 2,
      "title": "Fundamental Concepts",
      "sections": []
    },
    {
      "number": 3,
      "title": "File I/O",
      "sections": []
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": []
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": []
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": []
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": []
    },
    {
      "number": 8,
      "title": "Wrapup",
      "sections": []
    },
    {
      "number": 1,
      "title": "Course Introduction",
      "sections": [
        {
          "id": "1.1",
          "title": "Course overview",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.2",
          "title": "Course materials and resources",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.3",
          "title": "Common abbreviations",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.4",
          "title": "Introductions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 2,
      "title": "Fundamental Concepts",
      "sections": [
        {
          "id": "2.1",
          "title": "Error handling",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.2",
          "title": "System data types",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.3",
          "title": "Notes on code examples",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 3,
      "title": "File I/O",
      "sections": [
        {
          "id": "3.1",
          "title": "File I/O overview",
          "content": [
            "3.2open(),read(),write(), andclose()3-8"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.3",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.4",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": [
        {
          "id": "4.1",
          "title": "Process IDs",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.2",
          "title": "Process memory layout",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.3",
          "title": "Command-line arguments",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.4",
          "title": "The environment list",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.5",
          "title": "The/procfilesystem",
          "content": [
            "Detailed table of contents"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [
            "Detailed table of contents"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 8,
      "title": "Wrapup",
      "sections": [
        {
          "id": "8.1",
          "title": "Wrapup",
          "content": [
            "This page intentionally blank",
            "But, here’s a tech talk you might enjoy:",
            "Deconstructing Privilege",
            "Patricia Aas, NDC Oslo 2019",
            "(Not your average tech talk, but targeted at a technical audience and cleverly delivered in",
            "a technical way)",
            "https://www.youtube.com/watch?v=02gpZuK5gF8",
            "Linux System Programming Essentials",
            "Course Introduction",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 1,
      "title": "Course Introduction",
      "sections": [
        {
          "id": "1.1",
          "title": "Course overview",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.2",
          "title": "Course materials and resources",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.3",
          "title": "Common abbreviations",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.4",
          "title": "Introductions",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 1,
      "title": "Course Introduction",
      "sections": [
        {
          "id": "1.1",
          "title": "Course overview",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.2",
          "title": "Course materials and resources",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.3",
          "title": "Common abbreviations",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.4",
          "title": "Introductions",
          "content": [
            "Course prerequisites",
            "Prerequisites",
            "(Good) reading knowledge of C",
            "Can log in to Linux / UNIX and use basic commands",
            "Knowledge ofmake(1)is helpful",
            "(Can do a short tutorial during first practical session for",
            "those new tomake)",
            "Assumptions",
            "You are familiar with commonly used parts of standard C",
            "library",
            "e.g.,stdioandmallocpackages",
            "Course goals",
            "Aimed at programmers building/understanding low-level",
            "applications",
            "Gain strong understanding of programming API that kernel",
            "presents to user-space",
            "System calls",
            "Relevant C library functions",
            "Other interfaces (e.g.,/proc)",
            "Necessarily, we sometimes delve into inner workings of kernel",
            "(But... not an internals course)",
            "Course topics",
            "Course flyer",
            "For more detail, see TOC in course book(s)",
            "Lab sessions",
            "Lots of lab sessions...",
            "Pair/group work is strongly encouraged!",
            "Usually gets us through practical sessions faster",
            "⇒so we can cover more topics",
            "Read each exercise thoroughlybefore starting",
            "⇒exercise descriptions often includeimportant hints",
            "Lab sessions arenotinstructor down time...",
            "⇒One-on-one questions about course material or exercises",
            "Coding exercises",
            "For coding exercises, you can use any suitable programming",
            "language in which you are proficient",
            "C/C++ (easiest...)",
            "Go, D, Rust, & other languages that compile to native",
            "machine code",
            "Most features can also be exercised from scripting languages",
            "such as Python, Ruby, and Perl",
            "Templatesolutions are provided for most coding exercises",
            "Filenames:ex.*.c",
            "Look for “FIXMEs” to see what parts you must complete",
            "\"",
            "You need to edit correspondingMakefileto add a new",
            "target for the executable",
            "Solutionswill be mailed out shortly after end of course",
            "Lab sessions: some thoughts on building code",
            "Many warnings indicate real problems in the code; fix them",
            "And the “harmless warnings” create noise that hides the",
            "serious warnings; fix them too",
            "This is a good thing:cc -Werror",
            "Treat all warnings as errors",
            "https://stackoverflow.com/questions/57842756/",
            "why-should-i-always-enable-compiler-warnings",
            "Rather than writing lots of code before first compile, use a",
            "frequent edit-save-build cycle to catch compiler errors early",
            "E.g., run the following in a separate window as you edit:",
            "$whileinotifywait -q . ;doecho -e'\\n\\n'; make; done",
            "inotifywaitis provided in theinotify-toolspackage",
            "(Theechocommand just injects some white space between",
            "each build)",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 1,
      "title": "Course Introduction",
      "sections": [
        {
          "id": "1.1",
          "title": "Course overview",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.2",
          "title": "Course materials and resources",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.3",
          "title": "Common abbreviations",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.4",
          "title": "Introductions",
          "content": [
            "Course materials",
            "Slides / course book",
            "Source code tarball",
            "Location sent by email",
            "Unpacked source code is a Git repository; you can",
            "commit/revert changes, etc.",
            "Kerrisk, M.T. 2010.The Linux Programming Interface",
            "(TLPI), No Starch Press.",
            "Further info on TLPI:http://man7.org/tlpi/",
            "API changes since publication:",
            "http://man7.org/tlpi/api_changes/",
            "(Slides frequently reference TLPI in bottom RHS corner)",
            "Other resources",
            "POSIX.1-2001 / SUSv3:",
            "http://www.unix.org/version3/",
            "POSIX.1-2008 / SUSv4:",
            "http://www.unix.org/version4/",
            "POSIX.1-2024 / SUSv5:",
            "https://pubs.opengroup.org/onlinepubs/9799919799/",
            "Manual pages",
            "Section 2: system calls",
            "Section 3: library functions",
            "Section 7: overviews",
            "Latest version online at",
            "http://man7.org/linux/man-pages/",
            "Latest tarball downloadable at",
            "https://mirrors.edge.kernel.org/pub/linux/docs/man-pages/",
            "Books",
            "General:",
            "Stevens, W.R., and Rago, S.A. 2013.Advanced Programming in the UNIX",
            "Environment (3rd edition). Addison-Wesley.",
            "http://www.apuebook.com/",
            "POSIX threads:",
            "Butenhof, D.R. 1996.Programming with POSIX Threads. Addison-Wesley.",
            "TCP/IP and network programming:",
            "Fall, K.R. and Stevens, W.R. 2013.TCP/IP Illustrated, Volume 1: The Protocols",
            "(2nd Edition). Addison-Wesley.",
            "Stevens, W.R., Fenner, B., and Rudoff, A.M. 2004.UNIX Network",
            "Programming,Volume 1 (3rd edition): The Sockets Networking API.",
            "Addison-Wesley.",
            "http://www.unpbook.com/",
            "Stevens, W.R. 1999.UNIX Network Programming, Volume 2 (2nd edition):",
            "Interprocess Communications. Prentice Hall.",
            "http://www.kohala.com/start/unpv22e/unpv22e.html",
            "Operating systems:",
            "Tanenbaum, A.S., and Woodhull, A.S. 2006.Operating Systems: Design And",
            "Implementation (3rd edition). Prentice Hall.",
            "(The Minix book)",
            "Comer, D. 2015.Operating System Design: The Xinu Approach (2nd edition)",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 1,
      "title": "Course Introduction",
      "sections": [
        {
          "id": "1.1",
          "title": "Course overview",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.2",
          "title": "Course materials and resources",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.3",
          "title": "Common abbreviations",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.4",
          "title": "Introductions",
          "content": [
            "Common abbreviations used in slides",
            "The following abbreviations are sometimes used in the slides:",
            "ACL: access control list",
            "COW: copy-on-write",
            "CV: condition variable",
            "CWD: current working directory",
            "EA: extended attribute",
            "EOF: end of file",
            "FD: file descriptor",
            "FS: filesystem",
            "FTM: feature test macro",
            "GID: group ID",
            "rGID, eGID, sGID, fsGID",
            "iff: “if and only if”",
            "IPC: interprocess communication",
            "KSE: kernel scheduling entity",
            "MQ: message queue",
            "MQD: message queue descriptor",
            "NS: namespace",
            "OFD: open file description",
            "PG: process group",
            "PID: process ID",
            "PPID: parent process ID",
            "SHM: shared memory",
            "SID: session ID",
            "SEM: semaphore",
            "SUS: Single UNIX specification",
            "UID: user ID",
            "rUID, eUID, sUID, fsUID",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 1,
      "title": "Course Introduction",
      "sections": [
        {
          "id": "1.1",
          "title": "Course overview",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.2",
          "title": "Course materials and resources",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.3",
          "title": "Common abbreviations",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "1.4",
          "title": "Introductions",
          "content": [
            "Introductions: me",
            "Programmer, trainer, writer",
            "UNIX since 1987, Linux since mid-1990s",
            "Active contributor to Linux",
            "API review, testing, and documentation",
            "API design and design review",
            "Lots of testing, lots of bug reports, a few kernel patches",
            "Maintainer of Linuxman-pagesproject (2004-2021)",
            "Documents kernel-user-space + C library APIs",
            "Contributor since 2000",
            "As maintainer:≈23k commits, 196 releases",
            "Author/coauthor of≈440 manual pages",
            "Kiwi in .de",
            "(mtk@man7.org, PGP: 4096R/3A35CE5E)",
            "http://linkedin.com/in/mkerrisk",
            "Introductions: you",
            "In brief:",
            "Who are you?",
            "If virtual: where are you?",
            "Two interesting things about you / things you like to do",
            "when you are not in front of a keyboard",
            "Questions policy",
            "General policy: ask questions any time, in one of the",
            "following ways:",
            "OnSlack",
            "If online, click the“Raise hand” button",
            "I’ll usually see it,and I get to see your name as well",
            "Or out loud",
            "But, wait for a quiet point",
            "And if online, please announce your name, since I might not",
            "be able to see you",
            "In the event that questions slow us down too much, I may",
            "say: “batch your questions until nextQuestion penguinslide”",
            "This page intentionally blank",
            "This page intentionally blank",
            "Linux System Programming Essentials",
            "Fundamental Concepts",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 2,
      "title": "Fundamental Concepts",
      "sections": [
        {
          "id": "2.1",
          "title": "Error handling",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.2",
          "title": "System data types",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.3",
          "title": "Notes on code examples",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 2,
      "title": "Fundamental Concepts",
      "sections": [
        {
          "id": "2.1",
          "title": "Error handling",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.2",
          "title": "System data types",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.3",
          "title": "Notes on code examples",
          "content": [
            "Error handling",
            "Most system calls and library functions return a status",
            "indicating success or failure",
            "On failure, most system calls:",
            "Return –1",
            "Place integer value in global variableerrnoto indicate cause",
            "Some library functions follow same convention",
            "Often, we’ll omit return values from slides, where they follow",
            "usual conventions",
            "Check manual pages for details",
            "Error handling",
            "Return status shouldalwaysbe tested",
            "\"",
            "Inspecterrnoonly if result status indicates failure",
            "APIs do not reseterrnoto 0 on success",
            "A successful call may modifyerrno(POSIX allows this)",
            "E.g., this is wrong:",
            "fd = open(pathname, O_RDONLY);",
            "printf(\"open() has returned\\n\");    // Might modify errno!",
            "if(fd == -1) {         // Did open() fail?",
            "perror(\"open\");     // Print message based on'errno'",
            "exit(EXIT_FAILURE);",
            "}",
            "errno",
            "When an API call fails,errnois set to indicate cause",
            "Integer value, global variable",
            "In multithreading environment, each thread has privateerrno",
            "Error numbers inerrnoare > 0",
            "<errno.h>defines symbolic names for error numbers",
            "#defineEPERM    1      /* Operation not permitted */",
            "#defineENOENT   2      /* No such file or directory */",
            "#defineESRCH    3      /* No such process */",
            "...",
            "errno(1)can be used to search for errors by number or name",
            "Part ofmoreutilspackage (since 2012)",
            "Checking for errors",
            "cnt = read(fd, buf, numbytes);",
            "if(cnt==-1) {          /* Was there an error? */",
            "if(errno==EINTR)",
            "fprintf(stderr, \"read() was interrupted by a signal\\n\");",
            "else if(errno==EBADF)",
            "fprintf(stderr, \"read() given bad file descriptor\\n\");",
            "else{",
            "/* Some other error occurred */",
            "}",
            "}",
            "Displaying error messages",
            "(More sophisticated programs might take actions other than",
            "terminating on syscall error)",
            "Displaying error messages",
            "Outline"
          ],
          "codeExamples": [
            "#include<stdio.h>\nvoidperror(const char*msg);\nOutputs tostderr:\nmsg+ “: ” + string corresponding to value inerrno\nE.g., iferrnocontainsEBADF,perror(\"close\")would display:\nclose: Bad file descriptor\nSimple error handling:\nfd = open(pathname, flags, mode);\nif(fd == -1) {\nperror(\"open\");\nexit(EXIT_FAILURE);\n}",
            "#include<string.h>\nchar*strerror(interrnum);\nReturns an error string corresponding to error inerrnum\nSame string as printed byperror()\nUnknown error number?⇒\"Unknown error nnn\"\nOrNULLon some systems"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 2,
      "title": "Fundamental Concepts",
      "sections": [
        {
          "id": "2.1",
          "title": "Error handling",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.2",
          "title": "System data types",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.3",
          "title": "Notes on code examples",
          "content": [
            "System data types",
            "Various system info needs to be represented in C",
            "Process IDs, user IDs, file offsets, etc.",
            "Using native C data types (e.g.,int,long) in application code",
            "would be nonportable; e.g.:",
            "sizeof(long)might be 4 on one system, but 8 on another",
            "One system might useintfor PIDs, while another useslong",
            "Even on same system, things may change across versions",
            "E.g., in kernel 2.4, Linux switched from 16 to 32-bit UIDs",
            "⇒POSIX defines system data types:",
            "Implementations must suitably define each system data type",
            "Defined viatypedef; e.g.,typedef int pid_t",
            "Most types have names suffixed “_t”",
            "Applications should use these types; e.g.,pid_t mypid;",
            "⇒will compile to correct types on any conformant system",
            "[TLPI§3.6.2]",
            "Examples of system data types",
            "Data type",
            "POSIX type",
            "requirement",
            "Description",
            "uid_tIntegerUser ID",
            "gid_tIntegerGroup ID",
            "Printing system data types",
            "Need to take care when passing system data types toprintf()",
            "Example:pid_tcan beshort,int, orlong",
            "Suppose we write:",
            "printf(\"My PID is: %d\\n\", getpid());",
            "Works fine if:",
            "Printing system data types",
            "On virtually all implementations, most integer system data",
            "types arelongor smaller",
            "⇒Promote tolongwhen printing system data types",
            "printf(\"My PID is: %ld\\n\", (long)getpid());",
            "Most notable exception:off_tis typicallylong long",
            "Promote tolong longforprintf()",
            "printf(\"Offset is %lld\\n\",",
            "(longlong)lseek(fd, 0, SEEK_CUR));",
            "Can also use%zuand%zdforsize_tandssize_t",
            "C99 hasintmax_t(uintmax_t) with%jd(%ju) specifier",
            "Solution for all integer types, but not on pre-C99 systems",
            "Must include<stdint.h>to get these type definitions",
            "Outline"
          ],
          "codeExamples": [
            "pid_tSigned integerProcess ID\nid_tInteger\nGeneric ID type; can holdpid_t,\nuid_t,gid_t\noff_tSigned integerFile offset or size\nsigset_tInteger or structureSignal set\nsize_tUnsigned integerSize of object (in bytes)\nssize_tSigned integerSize of object or error indication\ntime_tInteger/real-floatingTime in seconds since Epoch\ntimer_tArithmetic typePOSIX timer ID\n(Arithmetic type∈integer or floating type)",
            "pid_tisint\npid_tisshort(C promotesshortargument toint)\nButwhat ifpid_tislong(andlongis bigger thanint)?\n⇒argument exceeds range understood by format specifier\n(top bytes will be lost)"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 2,
      "title": "Fundamental Concepts",
      "sections": [
        {
          "id": "2.1",
          "title": "Error handling",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.2",
          "title": "System data types",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.3",
          "title": "Notes on code examples",
          "content": [
            "Code examples presented in course",
            "Code tarball== code from TLPI + further code for course",
            "Examples on slides edited/excerptedfor brevity",
            "E.g., error-handling code may be omitted",
            "Slides always showpathname for full source code",
            "Full source code always includes error-handling code",
            "Code license:",
            "GNU GPL v3 for programs",
            "GNU Lesser GPL v3 for libraries",
            "http://www.gnu.org/licenses/#GPL",
            "Understanding Open Source and Free Software Licensing,",
            "A.M. St Laurent, 2004",
            "Open Source Licensing: Software Freedom and Intellectual Property Law,",
            "L. Rosen, 2004",
            "Open Source Software: Rechtliche Rahmenbedingungen der Freien",
            "Software, Till Jaeger, 2020",
            "Droit des logiciels, F. Pellegrini & S. Canevet, 2013",
            "Example codelib/subdirectory",
            "lib/subdirectory contains code of a few functions",
            "commonly used in examples",
            "camelCasefunction name?",
            "⇒It’s mine",
            "Common header file",
            "Many code examples make use of header filetlpi_hdr.h",
            "Goal: make code examples a little shorter",
            "tlpi_hdr.h:",
            "Includes a few frequently used header files",
            "Includes declarations of some error-handling functions",
            "[TLPI§3.5.2]",
            "Error-handling functions used in examples",
            "Could handle errors as follows:",
            "fd = open(pathname, flags, mode);",
            "if(fd == -1) {",
            "perror(\"open\");",
            "exit(EXIT_FAILURE);",
            "}",
            "Verbose! To make error handling more compact, I define",
            "some simple error-handling functions",
            "Error-handling functions used in examples",
            "Error-handling functions used in examples",
            "Building the sample code",
            "You can manually compile the example programs, but there is",
            "also aMakefilein each directory",
            "⇒Typingmakein source code root directory builds the",
            "programs in most subdirectories",
            "If you encounter build errors relating to ACLs, capabilities, or",
            "SELinux, seehttp://man7.org/tlpi/code/faq.html",
            "Preferred solution is to install the necessary packages:",
            "Debian, Ubuntu:libcap-dev,libacl1-dev,libreadline-dev",
            "libcrypt-dev",
            "RPM-based systems:libcap-devel,libacl-devel,readline-devel",
            "libxcrypt-devel",
            "Using library functions from the sample code",
            "To use my library functions in your code:",
            "Includetlpi_hdr.hin your C source file",
            "Located inlib/subdirectory in source code",
            "Link against my library,libtlpi.a, located in source",
            "code root directory",
            "To build library, runmakein the source code root directory or",
            "inlib/subdirectory",
            "Method 1: Place your program in one of “my” directories,",
            "add target to correspondingMakefile, and build usingmake",
            "Method 2: Manually compile with the following command:",
            "cc -Isrc-root/lib yourprog.c src-root/libtlpi.a",
            "src-rootmust be replaced with the absolute or relative path",
            "of source code root directory",
            "This page intentionally blank",
            "But, here’s a tech talk you might enjoy:",
            "Postmodern strace",
            "Dmitry Levin, FOSDEM 2020",
            "https://www.youtube.com/watch?v=dxOYSGouY-0",
            "Linux System Programming Essentials",
            "File I/O",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [
            "#include\"tlpi_hdr.h\"\nerrExit(const char*format, ...);\nPrints error message onstderrthat includes:\nSymbolic name forerrnovalue (via some trickery)\nstrerror()description for currenterrnovalue\nText from theprintf()-style message supplied in arguments\nA terminating newline\nTerminates program with exit statusEXIT_FAILURE(1)\nExample:\nif(close(fd) == -1)\nerrExit(\"close (fd=%d)\", fd);\nmight produce:\nERROR [EBADF Bad file descriptor] close (fd=5)",
            "#include\"tlpi_hdr.h\"\nerrMsg(const char*format, ...);\nLikeerrExit(), but does not terminate program\n#include\"tlpi_hdr.h\"\nfatal(const char*format, ...);\nDisplays aprintf()-style message + newline\nTerminates program with exit statusEXIT_FAILURE(1)"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 3,
      "title": "File I/O",
      "sections": [
        {
          "id": "3.1",
          "title": "File I/O overview",
          "content": [
            "3.2open(),read(),write(), andclose()3-8"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.3",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.4",
          "title": "Exercises",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 3,
      "title": "File I/O",
      "sections": [
        {
          "id": "3.1",
          "title": "File I/O overview",
          "content": [
            "3.2open(),read(),write(), andclose()3-8"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.3",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.4",
          "title": "Exercises",
          "content": [
            "Files",
            "“On UNIX, everything is a file”",
            "More correctly: “everything is a file descriptor”",
            "Note: the termfilecan be ambiguous:",
            "Ageneric term, covering disk files, directories, sockets,",
            "FIFOs, terminals and other devices and so on",
            "Or specifically, adisk filein a filesystem",
            "To clearly distinguish the latter, the termregular fileis",
            "sometimes used",
            "System calls versusstdio",
            "C programs usually usestdiopackage for file I/O",
            "Library functions layered on top of I/O system calls",
            "System callsLibrary functions",
            "file descriptor (int)file stream (FILE *)",
            "open(),close()fopen(),fclose()",
            "lseek()fseek(),ftell()",
            "read()fgets(),fscanf(),fread(). . .",
            "write()fputs(),fprintf(),fwrite(), . . .",
            "–feof(),ferror()",
            "We presume understanding ofstdio;⇒focus on system calls",
            "File descriptors",
            "All I/O is done using file descriptors (FDs)",
            "nonnegative integer that identifies an open file",
            "Used for all types of files",
            "terminals, regular files, pipes, FIFOs, devices, sockets, ...",
            "(POSIX names are defined in<unistd.h>)",
            "FDPurposePOSIX namestdiostream",
            "0Standard inputSTDIN_FILENOstdin",
            "1Standard outputSTDOUT_FILENOstdout",
            "2Standard errorSTDERR_FILENOstderr",
            "Key file I/O system calls",
            "Four fundamental calls:",
            "open(): open a file, optionally creating it if needed",
            "Returns file descriptor used by remaining calls",
            "read(): input",
            "write(): output",
            "close(): close file descriptor",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 3,
      "title": "FDs are normally available to programs run from shell:",
      "sections": []
    },
    {
      "number": 3,
      "title": "File I/O",
      "sections": [
        {
          "id": "3.1",
          "title": "File I/O overview",
          "content": [
            "3.2open(),read(),write(), andclose()3-8"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.3",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.4",
          "title": "Exercises",
          "content": [
            "open(): opening a file",
            "open() flagsargument",
            "flagsis formed by ORing (|) together:",
            "Access mode",
            "Specify exactly one ofO_RDONLY,O_WRONLY, orO_RDWR",
            "File creation flags (bit flags)",
            "File status flags (bit flags)",
            "[TLPI§4.3.1]",
            "File creation flags",
            "File creation flags:",
            "Affect behavior ofopen()call",
            "Can’t be retrieved or changed",
            "Examples:",
            "O_CREAT: create file if it doesn’t exist",
            "modeargument must be specified",
            "WithoutO_CREAT, can open only an existing file (else:",
            "ENOENT)",
            "O_EXCL: create “exclusively”",
            "Give an error (EEXIST) if file already exists",
            "Only meaningful withO_CREAT",
            "O_TRUNC: truncate existing file to zero length",
            "I.e., discard existing file content",
            "File status flags",
            "File status flags:",
            "Affect semantics of subsequent file I/O",
            "Can be retrieved and modified usingfcntl()",
            "Examples:",
            "O_APPEND: always append writes to end of file",
            "O_NONBLOCK: nonblocking I/O",
            "open()examples",
            "Open existing file for reading:",
            "fd = open(\"script.txt\", O_RDONLY);",
            "Open file for read-write, create if necessary, ensure we are",
            "creator:",
            "fd = open(\"myfile.txt\", O_CREAT | O_EXCL | O_RDWR,",
            "S_IRUSR | S_IWUSR);       /* rw------- */",
            "Open file for writing, creating if necessary:",
            "fd = open(\"myfile.txt\", O_CREAT | O_WRONLY, S_IRUSR);",
            "File opened for writing, but created with only read",
            "permission!",
            "read(): reading from a file",
            "write(): writing to a file",
            "close(): closing a file",
            "Example: copy.c",
            "$ ./copy old-file new-file",
            "A simple version ofcp(1)",
            "Example:fileio/copy.c",
            "Always remember to handle errors!",
            "1",
            "#define BUF_SIZE 1024",
            "2",
            "Universality of I/O",
            "The fundamental I/O system calls work on almost all file",
            "types:",
            "$ ls > mylist",
            "$ ./copy mylist new        # Regular file",
            "$ ./copy mylist /dev/tty   # Device",
            "$ mkfifo f                 # FIFO",
            "$ cat f &                  # (reads from FIFO)",
            "$ ./copy mylist f          # (writes to FIFO)",
            "Outline"
          ],
          "codeExamples": [
            "#include<sys/stat.h>\n#include<fcntl.h>\nintopen(const char*pathname,intflags, ... /* mode_t mode */);\nOpens existing file / creates and opens new file\nArguments:\npathnameidentifies file to open\nflagscontrols semantics of call\ne.g., open an existing file vs create a new file\nmodespecifies permissions when creating new file\nReturns: a file descriptor (nonnegative integer)\n(Guaranteed to be lowest available FD)\n[TLPI§4.3]",
            "#include<unistd.h>\nssize_t read(intfd,void*buffer, size_t count);\nfd: file descriptor\nbuffer: pointer to buffer to store data\ncount: number of bytes to read\n(buffermust be at least this big)\n(ssize_tandsize_tare signed and unsigned integer types)\nReturns:\n> 0: number of bytes read\nMay be <count(e.g., terminalread()gets only one line)\n0: end of file\n–1: error\n\"\nNo terminating null byte is placed at end of buffer",
            "#include<unistd.h>\nssize_t write(intfd,const void*buffer, size_t count);\nfd: file descriptor\nbuffer: pointer to data to be written\ncount: number of bytes to write\nReturns:\nNumber of bytes written\nMay be <count(a “partial write”)\n(e.g., write fills device, or insufficient space to write entire\nbuffer to nonblocking socket)\n–1 on error",
            "#include<unistd.h>\nintclose(intfd);\nfd: file descriptor\nReturns:\n0: success\n–1: error\nReally should check for error!\nAccidentally closing same FD twice\nI.e., detect program logic error\nFilesystem-specific errors\nE.g., NFS commit failures may be reported only atclose()\nNote:close()alwaysreleases FD, even on failure return\nSeeclose(2)manual page",
            "char buf[BUF_SIZE];\n3\n4\nint infd = open(argv[1], O_RDONLY);\n5\nif (infd == -1) errExit(\"open %s\", argv[1]);\n6\n7\nint flags = O_CREAT | O_WRONLY | O_TRUNC;\n8\nmode_t mode = S_IRUSR | S_IWUSR | S_IRGRP;     /* rw-r----- */\n9\nint outfd = open(argv[2], flags, mode);\n10\nif (outfd == -1) errExit(\"open %s\", argv[2]);\n11\n12\nssize_t nread;\n13\nwhile ((nread = read(infd, buf, BUF_SIZE)) > 0)\n14\nif (write(outfd, buf, nread)!= nread)\n15\nfatal(\"write() returned error or partial write occurred\");\n16\nif (nread == -1) errExit(\"read\");\n17\n18\nif (close(infd)== -1) errExit(\"close\");\n19\nif (close(outfd)== -1) errExit(\"close\");"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 3,
      "title": "File I/O",
      "sections": [
        {
          "id": "3.1",
          "title": "File I/O overview",
          "content": [
            "3.2open(),read(),write(), andclose()3-8"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.3",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.4",
          "title": "Exercises",
          "content": [
            "API summary",
            "intopen(const char*pathname,intflags, ... /* mode_t mode */);",
            "// Returns a file descriptor",
            "Outline"
          ],
          "codeExamples": [
            "ssize_t read(intfd,void*buffer, size_t count);\n// Returns: # of bytes actually read or 0 for EOF\nssize_t write(intfd,const void*buffer, size_t count);\n// Returns: # of bytes actually written\nintclose(intfd);"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 3,
      "title": "File I/O",
      "sections": [
        {
          "id": "3.1",
          "title": "File I/O overview",
          "content": [
            "3.2open(),read(),write(), andclose()3-8"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.3",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "3.4",
          "title": "Exercises",
          "content": [
            "Notes for online practical sessions",
            "Small groups inbreakout rooms",
            "Write a note into Slack if you have a preferred group",
            "We will go faster, if groups collaborateon solving the",
            "exercise(s)",
            "You canshare a screenin your room",
            "I will circulate regularly between rooms to answer questions",
            "Zoom has an “Ask for help” button...",
            "Keep an eye on the#generalSlack channel",
            "Perhaps with further info about exercise;",
            "Or a note that the exercise merges into a break",
            "When your room has finished, write a message in the Slack",
            "channel:“***** Room X has finished *****”",
            "Then I have an idea of how many people have finished",
            "Shared screen etiquette",
            "It may help your colleagues if youuse a larger than normal font!",
            "In many environments (e.g.,xterm,VS Code), we can adjust the",
            "font size withControl+Shift+“+” andControl+“-”",
            "Or (e.g.,emacs) hold downControlkey and use mouse wheel",
            "Long shell promptsmake reading your shell session difficult",
            "UsePS1='$'orPS1='#'",
            "Low contrastcolor themes are difficult to read; change this if you can",
            "Turn online numberingin your editor",
            "Invimuse::set number",
            "Inemacsuse:M-x display-line-numbers-mode <RETURN>",
            "M-xmeansLeft-Alt+x",
            "For collaborative editing,relative line-numbering is evil....",
            "Invimuse::set nornu",
            "Inemacs, the following should suffice:",
            "M-: (display-line-numbers-mode) <RETURN>",
            "M-: (setq display-line-numbers'absolute) <RETURN>",
            "M-:meansLeft-Alt+Shift+:",
            "Usingtmatein in-person practical sessions",
            "In order to share an X-term session with others, do the following:",
            "Enter the commandtmatein an X-term, and you’ll see the following:",
            "$ tmate",
            "...",
            "Connecting to ssh.tmate.io...",
            "Note: clear your terminal before sharing readonly access",
            "web session read only: ...",
            "sshsessionreadonly: ssh S0mErAnD0m5Tr1Ng@lon1.tmate.io",
            "web session: ...",
            "sshsession:sshS0mEoTheRrAnD0m5Tr1Ng@lon1.tmate.io",
            "Share last “ssh” string with colleague(s) via Slack or another channel",
            "Or: \"ssh session read only\" string gives others read-only access",
            "Your colleagues should paste that string into an X-term...",
            "Now, you are sharing an X-term session in which anyone can type",
            "Any \"mate\" can cut the connection to the session with the",
            "3-character sequence<ENTER>∼.",
            "To see above message again:tmate show-messages",
            "Exercise notes",
            "For many exercises, there are templates for the solutions",
            "Filenames:ex.*.c",
            "Look for FIXMEs to see what pieces of code you must add",
            "\"",
            "You will need to edit the correspondingMakefileto add",
            "a new target for the executable",
            "Look for theEXERCISE_FILES_EXEmacro",
            "-EXERCISE_FILES_EXE = # ex.prog_a ex.prob_b",
            "+EXERCISE_FILES_EXE = ex.prog_a # ex.prog_b",
            "Get amaketutorial now if you need one",
            "Exercise",
            "1",
            "Usingopen(),close(),read(), andwrite(), implement the command",
            "tee [-a] file([template:fileio/ex.tee.c]). This command",
            "writes a copy of its standard input to standard output and tofile. If",
            "filedoes not exist, it should be created. Iffilealready exists, it",
            "should be truncated to zero length (O_TRUNC). The program should",
            "support the-aoption, which appends (O_APPEND) output to the file if",
            "it already exists, rather than truncating the file.",
            "Some hints:",
            "You can build../libtlpi.aby doingmakein source code root directory.",
            "Standard input & output are automatically opened for a process.",
            "Remember that you will need to add a target in theMakefile!",
            "After first doing some simple command-line testing, test using the unit test in",
            "theMakefile:make tee_test.",
            "Why does “man open” show the wrong manual page? It finds a page in the",
            "wrong section first. Try “man 2 open” instead.",
            "while inotifywait -q . ; do echo -e'\\n\\n'; make; done",
            "You may need to install theinotify-toolspackage",
            "Command-line options can be parsed usinggetopt(3).",
            "This page intentionally blank",
            "Linux System Programming Essentials",
            "Processes",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": [
        {
          "id": "4.1",
          "title": "Process IDs",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.2",
          "title": "Process memory layout",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.3",
          "title": "Command-line arguments",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.4",
          "title": "The environment list",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.5",
          "title": "The/procfilesystem",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": [
        {
          "id": "4.1",
          "title": "Process IDs",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.2",
          "title": "Process memory layout",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.3",
          "title": "Command-line arguments",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.4",
          "title": "The environment list",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.5",
          "title": "The/procfilesystem",
          "content": [
            "Process ID",
            "Parent process ID",
            "Outline"
          ],
          "codeExamples": [
            "#include<unistd.h>\npid_t getpid(void);\nProcess== running instance of a program\nProgram + program loader (kernel)⇒process\nEvery process has a process ID (PID)\npid_t: positive integer that uniquely identifies process\ngetpid()returns callers’s PID\nKernel allocates PIDs using “elevator” algorithm\nWhen elevator reaches top of range, it then cycles, reusing\nPIDs starting at low end of range\nMaximum PID is 32767 on Linux\nAll PID slots used?⇒fork()fails withEAGAIN\nLimit adjustable via/proc/sys/kernel/pid_max(up to\nkernel’sPID_MAX_LIMITconstant, typically 4*1024*1024)\n[TLPI§6.2]",
            "#include<unistd.h>\npid_t getppid(void);\nEvery process has a parent\nTypically, process that created this process usingfork()\nParent process is informed when its child terminates\nAll processes on system thus form a tree\nAt root isinit, PID 1, the ancestor of all processes\n“Orphaned” processes are “adopted” byinit\ngetppid()returns PID of caller’s parent process (PPID)\n[TLPI§6.2]"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": [
        {
          "id": "4.1",
          "title": "Process IDs",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.2",
          "title": "Process memory layout",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.3",
          "title": "Command-line arguments",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.4",
          "title": "The environment list",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.5",
          "title": "The/procfilesystem",
          "content": [
            "Process memory layout",
            "Virtual memory of a process is divided intosegments:",
            "Text: machine-language instructions",
            "Marked read-only to prevent self-modification",
            "Multiple processes can share same code in memory",
            "Initialized data: global and static variables that are",
            "explicitly initialized",
            "Values read from program file when process is created",
            "Uninitialized data: global and static variables that are not",
            "explicitly initialized",
            "Initialized to zero when process is created",
            "Stack: storage for function local variables and call linkage",
            "info (saved SP and PC registers)",
            "Heap: an area from which memory can be dynamically",
            "allocated and deallocated",
            "malloc()andfree()",
            "Process memory layout (simplified)",
            "argv,environ",
            "Stack",
            "(grows downward)",
            "(unallocated memory)",
            "Heap",
            "(grows upward)",
            "Uninitialized data (bss)",
            "Initialized data",
            "Te xt(program code)",
            "Memory",
            "mappings",
            "placed here",
            "Lowvirtual",
            "address",
            "High virtual",
            "address",
            "[TLPI§6.3]",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": [
        {
          "id": "4.1",
          "title": "Process IDs",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.2",
          "title": "Process memory layout",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.3",
          "title": "Command-line arguments",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.4",
          "title": "The environment list",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.5",
          "title": "The/procfilesystem",
          "content": [
            "Command-line arguments",
            "Command-line arguments of a program provided as first two",
            "arguments ofmain()",
            "Conventionally namedargcandargv",
            "procexec/show_argv.c",
            "Display command-line arguments of program",
            "intmain(intargc,char*argv[]) {",
            "printf(\"Program invoked with:\\n\");",
            "printf(\"    argv[0] == %s\\n\\n\", argv[0]);",
            "printf(\"Remaining arguments:\\n\");",
            "for(intj = 1; ; j++) {",
            "printf(\"    argv[%d] = %s\\n\", j, argv[j]);",
            "if(argv[j] == NULL)",
            "break;",
            "}",
            "exit(EXIT_SUCCESS);",
            "}",
            "Example run:",
            "$ ./show_argvabc",
            "Program invoked with:",
            "argv[0]==./show_argv",
            "Remaining arguments:",
            "argv[1] = a",
            "argv[2] = b",
            "argv[3] = c",
            "argv[4]=(null)",
            "Outline"
          ],
          "codeExamples": [
            "int argc: number of arguments\nchar *argv[]: array of pointers to arguments (strings)\nargv[0]== name used to invoke program\nargv[argc] == NULL\nE.g., for the command,necho hello world:\n[TLPI§6.6]"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": [
        {
          "id": "4.1",
          "title": "Process IDs",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.2",
          "title": "Process memory layout",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.3",
          "title": "Command-line arguments",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.4",
          "title": "The environment list",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.5",
          "title": "The/procfilesystem",
          "content": [
            "Environment list (environ)",
            "Each process has a list ofenvironment variables",
            "Strings of formname=value",
            "New process inherits copy of parent’s environment",
            "Simple (one-way) interprocess communication",
            "Commonly used to control behavior of programs",
            "Examples:",
            "HOME: user’s home directory (initialized at login)",
            "PATH: list of directories to search for executable programs",
            "EDITOR: user’s preferred editor",
            "[TLPI§6.7]",
            "Environment list (environ)",
            "Can create environment variables within shell:",
            "$ MANWIDTH=72          # Create shell var.",
            "$ export MANWIDTH      # Turn shell var. into environment var.",
            "$ man getpid",
            "Or:export MANWIDTH=72",
            "All processes created by shell will inherit definition",
            "Creating an environment variable for a single command (does",
            "not modify shell’s environment):",
            "$ MANWIDTH=72 man getpid",
            "To list all environment variables, useenv(1)orprintenv(1)",
            "Accessing the environment from a program",
            "Environment list can be accessed via a global variable:",
            "extern char**environ;",
            "NULL-terminated array of pointers to strings:",
            "Displaying environment:",
            "for(char**ep = environ; *ep != NULL; ep++)",
            "puts(*ep);",
            "Environment variable APIs",
            "Fetching value of an EV:value = getenv(\"NAME\");",
            "Creating/modifying an EV:",
            "putenv(\"NAME=value\");",
            "setenv(\"NAME\", \"value\", overwrite);",
            "Removing an EV:unsetenv(\"NAME\");",
            "/proc/PID/environcan be used (with suitable permissions)",
            "to view environment of another process",
            "See manual pages and TLPI§6.7",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 4,
      "title": "Processes",
      "sections": [
        {
          "id": "4.1",
          "title": "Process IDs",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.2",
          "title": "Process memory layout",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.3",
          "title": "Command-line arguments",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.4",
          "title": "The environment list",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.5",
          "title": "The/procfilesystem",
          "content": [
            "The/procfilesystem",
            "Pseudofilesystem that exposes kernel information via",
            "filesystem metaphor",
            "Structured as a set of subdirectories and files",
            "proc(5)manual page",
            "Files don’t really exist",
            "Created on-the-fly when pathnames under/procare",
            "accessed",
            "Many files read-only",
            "Some files are writable⇒can update kernel settings",
            "Named “/proc” because earliest implementations (pre-Linux, 1980s) exposed info",
            "only about processes",
            "https://en.wikipedia.org/wiki/Procfs",
            "The/procfilesystem: examples",
            "/proc/cmdline: command line used to start kernel",
            "/proc/cpuinfo: info about CPUs on the system",
            "/proc/meminfo: info about memory and memory usage",
            "/proc/modules: info about loaded kernel modules",
            "/proc/sys/fs/: files and subdirectories with",
            "filesystem-related info",
            "/proc/sys/kernel/: files and subdirectories with various",
            "readable/settable kernel parameters",
            "/proc/sys/net/: files and subdirectories with various",
            "readable/settable networking parameters",
            "/proc/PID/directories",
            "One/proc/PID/subdirectory for each running process",
            "Subdirectories and files exposing info about process with",
            "corresponding PID",
            "Some files publicly readable, some readable only by process",
            "owner; a few files writable",
            "Examples",
            "cmdline: command line used to start program",
            "cwd: current working directory",
            "environ: environment of process",
            "fd: directory with info about open file descriptors",
            "limits: resource limits",
            "maps: mappings in virtual address space",
            "status: (lots of) info about process",
            "Linux System Programming Essentials",
            "Signals",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Signals are a notification mechanism",
            "Signal == notification to a process that an event occurred",
            "“Software interrupts”",
            "asynchronous: receiver (generally) can’t predict when a",
            "signal will occur",
            "Signal types",
            "64 signals (on Linux)",
            "Each signal has a unique integer value",
            "Numbered starting at 1",
            "\"",
            "Defined symbolically in<signal.h>:",
            "Names of formSIGxxx",
            "e.g., signal 2 isSIGINT(“terminal interrupt”)",
            "Two broad categories of signals:",
            "“Standard” signals (1 to 31)",
            "Mostly for kernel-defined purposes",
            "Realtime signals (32 to 64)",
            "Exist for user-defined purposes",
            "[TLPI§20.1]",
            "Signal generation",
            "Signals can be sent to a process by:",
            "The kernel (the common case)",
            "Another process (with suitable permissions)",
            "kill(pid, sig)and related APIs",
            "Kernel generates signals for various events, e.g.:",
            "Attempt to access a nonexistent memory address (SIGSEGV)",
            "Terminalinterruptcharacter (Control-C) was typed (SIGINT)",
            "Child process terminated (SIGCHLD)",
            "Process CPU time limit exceeded (SIGXCPU)",
            "[TLPI§20.1]",
            "Terminology",
            "Some terminology:",
            "A signal isgeneratedwhen an event occurs",
            "Later, a signal isdeliveredto the process, which then takes",
            "some action in response",
            "Between generation and delivery, a signal ispending",
            "We canblock(delay) delivery of specific signals by adding",
            "them to process’ssignal mask",
            "Signal mask == set of signals whose delivery is blocked",
            "Pending signal is delivered only after it is unblocked",
            "[TLPI§20.1]",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Signal default actions",
            "When a signal is delivered, a process takes one of these",
            "default actions:",
            "Ignore: signal is discarded by kernel, has no effect on process",
            "Terminate: process is terminated (“killed”)",
            "Core dump + terminate: process produces a core dump",
            "and is terminated",
            "Core dump file can be used to examine state of program",
            "inside a debugger",
            "See alsocore(5)manual page",
            "Stop: execution of process is suspended",
            "Continue: execution of a stopped process is resumed",
            "Default action for each signal is signal-specific",
            "[TLPI§20.2]",
            "Standard signals and their default actions",
            "NameDescriptionDefault",
            "SIGABRTAbort processCore",
            "SIGALRMReal-time timer expirationTerm",
            "SIGBUSMemory access errorCore",
            "SIGCHLDChild stopped or terminatedIgnore",
            "SIGCONTContinue if stoppedCont",
            "SIGFPEArithmetic exceptionCore",
            "SIGHUPHangupTerm",
            "SIGILLIllegal instructionCore",
            "SIGINTInterrupt from keyboardTerm",
            "SIGIOI/O possibleTerm",
            "SIGKILLSure killTerm",
            "SIGPIPEBroken pipeTerm",
            "SIGPROFProfiling timer expiredTerm",
            "SIGPWRPower about to failTerm",
            "SIGQUITTerminal quitCore",
            "SIGSEGVInvalid memory referenceCore",
            "SIGSTKFLTStack fault on coprocessorTerm",
            "SIGSTOPSure stopStop",
            "SIGSYSInvalid system callCore",
            "SIGTERMTerminate processTerm",
            "SIGTRAPTrace/breakpoint trapCore",
            "SIGTSTPTerminal stopStop",
            "SIGTTINTerminal input from backgroundStop",
            "SIGTTOUTerminal output from backgroundStop",
            "SIGURGUrgent data on socketIgnore",
            "SIGUSR1User-defined signal 1Term",
            "SIGUSR2User-defined signal 2Term",
            "SIGVTALRMVirtual timer expiredTerm",
            "SIGWINCHTerminal window size changedIgnore",
            "SIGXCPUCPU time limit exceededCore",
            "SIGXFSZFile size limit exceededCore",
            "Signal default actions are:",
            "Term: terminate the process",
            "Core: produce core dump and",
            "terminate the process",
            "Ignore: ignore the signal",
            "Stop: stop (suspend) the process",
            "Cont: resume process (if stopped)",
            "SIGKILLandSIGSTOPcan’t be caught,",
            "blocked, or ignored",
            "TLPI§20.2",
            "Stop and continue signals",
            "Certain signalsstopa process, freezing its execution",
            "Examples:",
            "SIGTSTP: “terminal stop” signal, generated by typing",
            "Control-Z",
            "SIGSTOP: “sure stop” signal",
            "SIGCONTcauses a stopped process to resume execution",
            "SIGCONTis ignored if process is not stopped",
            "Most common use of these signals is inshell job control",
            "Changing a signal’s disposition",
            "Instead of default, we can change a signal’s disposition to:",
            "Ignorethe signal",
            "Handle (“catch”) the signal: execute a user-defined",
            "function upon delivery of the signal",
            "Revert to thedefault action",
            "Useful if we earlier changed disposition",
            "Can’t change disposition toterminateorcore dump +",
            "terminate",
            "But, a signal handler can emulate these behaviors",
            "Can’t change disposition ofSIGKILLorSIGSTOP(error:",
            "EINVAL)",
            "So, they always kill or stop a process",
            "Changing a signal’s disposition:sigaction()",
            "sigactionstructure",
            "structsigaction {",
            "void(*sa_handler)(int);",
            "sigset_t sa_mask;",
            "intsa_flags;",
            "void(*sa_restorer)(void);",
            "};",
            "sa_handlerspecifies disposition of signal:",
            "Address of a signal handler function",
            "SIG_IGN: ignore signal",
            "SIG_DFL: revert to default disposition",
            "sa_mask: signals to block while handler is executing",
            "Field is initialized using macros described insigsetops(3)",
            "sa_flags: bit mask of flags affecting invocation of handler",
            "sa_restorer: not for application use",
            "Used internally to implement “signal trampoline”",
            "Ignoring a signal (signals/ignore_signal.c)",
            "intignoreSignal(intsig)",
            "{",
            "structsigaction sa;",
            "sa.sa_handler = SIG_IGN;",
            "sa.sa_flags = 0;",
            "sigemptyset(&sa.sa_mask);",
            "returnsigaction(sig, &sa, NULL);",
            "}",
            "A “library function” that ignores specified signal",
            "sa_maskfield is significant only when establishing a signal",
            "handler, but for best practice we initialize to sensible value",
            "Outline"
          ],
          "codeExamples": [
            "#include<signal.h>\nintsigaction(intsig,const structsigaction *act,\nstructsigaction *oldact);\nsigaction()changes (and/or retrieves) disposition of signalsig\nsigactionstructure describes a signal’s disposition\nactpoints to structure specifying new disposition forsig\noldactreturns previous disposition forsig\nCan beNULLif we don’t care\nsigaction(sig, NULL, &oldact)returns current\ndisposition, without changing it\n[TLPI§20.13]"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Displaying signal descriptions",
            "#define_GNU_SOURCE",
            "Example:signals/t_strsignal.c",
            "intmain(intargc,char*argv[]) {",
            "for(intsig = 1; sig < NSIG; sig++)",
            "printf(\"%2d: %s\\n\", sig, strsignal(sig));",
            "exit(EXIT_SUCCESS);",
            "}",
            "$ ./t_strsignal",
            "1: Hangup",
            "2: Interrupt",
            "3: Quit",
            "4: Illegal instruction",
            "5: Trace/breakpoint trap",
            "6: Aborted",
            "7: Bus error",
            "8: Floating point exception",
            "9: Killed",
            "10: User defined signal 1",
            "11: Segmentation fault",
            "12: User defined signal 2",
            "13: Broken pipe",
            "...",
            "Waiting for a signal:pause()",
            "Other APIs to learn about",
            "sigprocmask(2): explicitly modify process signal mask to",
            "control which signals are blocked",
            "sigpending(2): discover which signals are pending for calling",
            "process",
            "Outline"
          ],
          "codeExamples": [
            "#include<string.h>\nchar*strsignal(intsig);\nReturns string describing signalsig\nNSIGconstant is 1 greater than maximum signal number\nDefine_GNU_SOURCEto get definition from<signal.h>\n[TLPI§20.8]",
            "#include<unistd.h>\nintpause(void);\nBlocks execution of caller until a signal is caught\nAlways returns –1 witherrnoset toEINTR\n(Standard return for blocking system call that is interrupted\nby a signal handler)\n(See alsosigsuspend(2))\n[TLPI§20.14]"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Signal handlers",
            "Programmer-defined function",
            "Called with one integer argument: number of signal",
            "⇒handler installed for multiple signals can differentiate...",
            "Returnsvoid",
            "void",
            "myHandler(intsig)",
            "{",
            "/* Actions to be performed when signal is delivered */",
            "}",
            "[TLPI§20.4]",
            "Signal handler invocation",
            "Automatically invoked by kernel when signal is delivered:",
            "Can interrupt main program flow at any time",
            "On return, execution continues at point of interruption",
            "Example:signals/ouch_sigaction.c",
            "Print “Ouch!” when Control-C is typed at keyboard",
            "1static voidsigHandler(intsig) {",
            "2     printf(\"Ouch!\\n\");              /* UNSAFE */",
            "3 }",
            "4",
            "5intmain(intargc,char*argv[]) {",
            "6structsigaction sa;",
            "7     sa.sa_flags = 0;                /* No flags */",
            "8     sa.sa_handler=sigHandler;     /* Handler function */",
            "9     sigemptyset(&sa.sa_mask);       /* Don't block additional signals",
            "10                                        during invocation of handler */",
            "11if(sigaction(SIGINT, &sa, NULL) == -1)",
            "12         errExit(\"sigaction\");",
            "13",
            "14for(;;)",
            "15         pause();                    /* Wait for a signal */",
            "16 }",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Notes for online practical sessions",
            "Small groups inbreakout rooms",
            "Write a note into Slack if you have a preferred group",
            "We will go faster, if groups collaborateon solving the",
            "exercise(s)",
            "You canshare a screenin your room",
            "I will circulate regularly between rooms to answer questions",
            "Zoom has an “Ask for help” button...",
            "Keep an eye on the#generalSlack channel",
            "Perhaps with further info about exercise;",
            "Or a note that the exercise merges into a break",
            "When your room has finished, write a message in the Slack",
            "channel:“***** Room X has finished *****”",
            "Then I have an idea of how many people have finished",
            "Shared screen etiquette",
            "It may help your colleagues if youuse a larger than normal font!",
            "In many environments (e.g.,xterm,VS Code), we can adjust the",
            "font size withControl+Shift+“+” andControl+“-”",
            "Or (e.g.,emacs) hold downControlkey and use mouse wheel",
            "Long shell promptsmake reading your shell session difficult",
            "UsePS1='$'orPS1='#'",
            "Low contrastcolor themes are difficult to read; change this if you can",
            "Turn online numberingin your editor",
            "Invimuse::set number",
            "Inemacsuse:M-x display-line-numbers-mode <RETURN>",
            "M-xmeansLeft-Alt+x",
            "For collaborative editing,relative line-numbering is evil....",
            "Invimuse::set nornu",
            "Inemacs, the following should suffice:",
            "M-: (display-line-numbers-mode) <RETURN>",
            "M-: (setq display-line-numbers'absolute) <RETURN>",
            "M-:meansLeft-Alt+Shift+:",
            "Usingtmatein in-person practical sessions",
            "In order to share an X-term session with others, do the following:",
            "Enter the commandtmatein an X-term, and you’ll see the following:",
            "$ tmate",
            "...",
            "Connecting to ssh.tmate.io...",
            "Note: clear your terminal before sharing readonly access",
            "web session read only: ...",
            "sshsessionreadonly: ssh S0mErAnD0m5Tr1Ng@lon1.tmate.io",
            "web session: ...",
            "sshsession:sshS0mEoTheRrAnD0m5Tr1Ng@lon1.tmate.io",
            "Share last “ssh” string with colleague(s) via Slack or another channel",
            "Or: \"ssh session read only\" string gives others read-only access",
            "Your colleagues should paste that string into an X-term...",
            "Now, you are sharing an X-term session in which anyone can type",
            "Any \"mate\" can cut the connection to the session with the",
            "3-character sequence<ENTER>∼.",
            "To see above message again:tmate show-messages",
            "Exercise",
            "While a signal handler is executing, the signal that caused it",
            "to be invoked is (by default) temporarily added to the signal",
            "mask, so that it is blocked from further delivery until the",
            "signal handler returns. Consequently, execution of a signal",
            "handler can’t be interrupted by a further execution of the",
            "same handler. To demonstrate that this is so, modify the",
            "signal handler in thesignals/ouch_sigaction.cprogram",
            "to include the following after the existingprintf()statement:",
            "sleep(5);",
            "printf(\"Bye\\n\");",
            "Build and run the program, type control-C once, and then,",
            "while the signal handler is executing, type control-C three",
            "more times. What happens? In total, how many times is the",
            "signal handler called?",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Signal sets",
            "Various signal-related APIs work withsignal sets",
            "Signal set == data structure that represents multiple signals",
            "Data type:sigset_t",
            "Typically a bit mask, but not necessarily",
            "[TLPI§20.9]",
            "Manipulating signal sets",
            "Blocking signals (the signal mask)",
            "Each process has asignal mask–a set of signals whose",
            "delivery is currently blocked",
            "(In truth: eachthreadhas a signal mask...)",
            "If a blocked signal is generated, it remains pending until",
            "removed from signal mask",
            "The signal mask can be changed in various ways:",
            "While handler is invoked, thesignal that triggered the",
            "handleris (temporarily) added to signal mask",
            "While handler is invoked, any signals specified insa_mask",
            "are (temporarily) added to signal mask",
            "Explicitly, usingsigprocmask()",
            "Attempts to blockSIGKILL/SIGSTOPare silently ignored",
            "[TLPI§20.10]",
            "sigprocmask()",
            "sigprocmask()",
            "Example: temporarily blocking a signal",
            "The following code snippet shows how to temporarily block a",
            "signal (SIGINT) while executing a block of code",
            "sigset_t blocking, prev;",
            "sigemptyset(&blocking);",
            "sigaddset(&blocking, SIGINT);",
            "sigprocmask(SIG_BLOCK, &blocking, &prev);",
            "/* ... Code to execute with SIGINT blocked ... */",
            "sigprocmask(SIG_SETMASK, &prev, NULL);",
            "We might do this because main program wants to operate on",
            "global variables that signal handle would also access",
            "Pending signals",
            "Signals are not queued",
            "The set of pending (standard) signals is a mask",
            "⇒If same signal is generated multiple times while blocked, it",
            "will be delivered just once",
            "Outline"
          ],
          "codeExamples": [
            "#include<signal.h>\nintsigemptyset(sigset_t *set);\nintsigfillset(sigset_t *set);\nintsigaddset(sigset_t *set,intsig);\nintsigdelset(sigset_t *set,intsig);\nintsigismember(constsigset_t *set,intsig);\nsigemptyset()initializessetto contain no signals\nsigfillset()initializessetto contain all signals\nWemustinitialize set usingsigemptyset()orsigfillset()\nbefore employing macros below\nUsingmemset()to zero a signal set isnotcorrect\nsigaddset()addssigtoset\nsigdelset()removessigfromset\nsigismember()returns 1 ifsigis inset, 0 if it is not, or –1 on\nerror (e.g.,sigis invalid)",
            "#include<signal.h>\nintsigprocmask(inthow,constsigset_t *set, sigset_t *oldset);\nAdds signals to, or removes signals from, caller’s signal mask\n(Typical use: prevent interruption by signal handler while\nupdating a shared data structure)\nhowspecifies change to signal mask:\nSIG_BLOCK:addsignals insetto signal mask\nI.e.,unionwith existing signal mask\nSIG_UNBLOCK:removesignals insetfrom signal mask\nSIG_SETMASK:assignsetto signal mask\nI.e.,overwriteexisting signal mask\n[TLPI§20.10]",
            "#include<signal.h>\nintsigprocmask(inthow,constsigset_t *set, sigset_t *oldset);\noldsetreturns previous signal mask\nCan beNULLif we don’t care\nsigprocmask(how, NULL, &oldset)retrieves current\nmask without changing it\nhowis ignored\n[TLPI§20.10]",
            "#include<signal.h>\nintsigpending(sigset_t *set);\nBetween generation and delivery, a signal ispending\nPending state is normally unobservable unless signal is\nexplicitly blocked\nsigpending()returns (inset) the set of signals currently\npending for caller\nWe donotneed to initializesetbefore callingsigpending()\nCan examinesetusingsigismember():\nsigset_t pending;\nsigpending(&pending);\nif(sigismember(&pending, SIGINT))\nprintf(\"SIGINT (%s) is pending\\n\", strsignal(SIGINT));\n[TLPI§20.11]"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "API summary",
            "intsigaction(intsig,const structsigaction *act,structsigaction *oldact);",
            "// Change disposition of'sig'to'act'; returning previous",
            "// disposition in'oldact'",
            "structsigaction{",
            "void(*sa_handler)(int);    // Handler address or DIG_IGN or SIG_DFL",
            "sigset_t   sa_mask;// Signals to be blocked while handler runs",
            "intsa_flags;",
            "...",
            "};",
            "char*strsignal(intsig);// Return string describing a signal",
            "intpause(void);// Pause until interrupted by signal handler",
            "// Following are for manipulating signal sets (sigset_t):",
            "intsigemptyset(sigset_t *set);",
            "intsigfillset(sigset_t *set);",
            "intsigaddset(sigset_t *set,intsig);",
            "intsigdelset(sigset_t *set,intsig);",
            "intsigismember(constsigset_t *set,intsig);",
            "intsigprocmask(inthow,constsigset_t *set, sigset_t *oldset);",
            "// Modify the signal mask and return previous mask;",
            "//'how'can be SIG_BLOCK / SIG_UNBLOCK / SIG_SETMASK",
            "intsigpending(sigset_t *set);",
            "// Return set of pending signals in'set'",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Exercises",
            "The goal of these exercises is to experiment with signal handlers and the use",
            "of the signal mask to block delivery of signals. A template for both part 1",
            "and part 2 of the exercise is provided ([template:",
            "signals/ex.pending_sig_expt.c])",
            "Hint: don’t confuse the signal mask with thesa_maskfield that is",
            "passed tosigaction(). The signal mask is a process attribute maintained",
            "inside the kernel that can be directly modified using calls tosigaction(). The",
            "sa_maskfield specifies additional signals that should betemporarilyadded",
            "to the signal mask while a signal handler is executing.",
            "1",
            "Write a program that:",
            "Blocks all signals exceptSIGINT. This will require the use of",
            "sigprocmask()(slides 5-35 + 5-36) as well as the APIs for",
            "manipulating signal sets (slide 5-32).",
            "Usessigaction()(slides 5-13, 5-14, and 5-24) to establish a",
            "SIGINThandler that does nothing but return.",
            "Callspause()to wait for a signal.",
            "Exercises",
            "Afterpause()returns:",
            "determines the set of pending signals for the process (use",
            "sigpending(), slide 5-37);",
            "tests which signals are in that set (usesigismember(),",
            "iterating through all signals in the range1 <= s < NSIG; see",
            "slide 5-18);",
            "and prints the descriptions of those signals (strsignal()).",
            "Run the program and send it various signals (other thanSIGINTand",
            "signals that are ignored by default), using either thekillcommand from",
            "another terminal (kill -<sig> <pid>), or by typing signal-generating",
            "keys from the terminal where you run the program (Control-Z for",
            "SIGTSTP, Control-\\(or Control-4) forSIGQUIT). Then type Control-C",
            "to generateSIGINTand inspect the list of pending signals displayed by",
            "the program.",
            "[Exercises continue on following slide]",
            "Exercises",
            "2",
            "Extend the program created in the preceding exercise so that:",
            "Just after installing the handler forSIGINT, the program also",
            "installs a handler forSIGQUIT(generated when the Control-\\ key",
            "is pressed). The handler should print a message “SIGQUIT",
            "received”, and return.",
            "After displaying the list of pending signals, the program unblocks",
            "SIGQUITand callspause()once more. (",
            "\"",
            "Whichhowvalue",
            "should be given tosigprocmask()?)",
            "While the program is blocking signals (i.e., before typing Control-C), try",
            "typing Control-\\ multiple times. After Control-C is typed, how many",
            "times does theSIGQUIThandler display its message? Why?",
            "3",
            "If you run the program once more, and then from another terminal send",
            "theSIGKILLsignal to the program (kill -KILL <pid>), what",
            "happens? Why?",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Homework exercises",
            "1",
            "Suppose that a program has blocked a certain signal, and",
            "that signal has been generated and is pending for the",
            "process. What do you suppose will happen if the program",
            "changes the disposition of the signal to “ignore” (SIG_IGN)?",
            "Will the signal still be pending? Write a test program to",
            "verify your answer.",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 5,
      "title": "Signals",
      "sections": [
        {
          "id": "5.1",
          "title": "Overview of signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.2",
          "title": "Signal dispositions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.3",
          "title": "Useful signal-related functions",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.4",
          "title": "Signal handlers",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.5",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.6",
          "title": "Signal sets, the signal mask, and pending signals",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.9",
          "title": "Homework exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.10",
          "title": "Designing signal handlers",
          "content": [
            "Designing signal handlers",
            "Signal handlers can, in theory, do anything",
            "But, complex signal handlers can easily have subtle bugs",
            "(e.g., race conditions)",
            "E.g., if main program and signal handler access same global",
            "variables",
            "\"",
            "Readsignal-safety(7)manual page!",
            "⇒Design signal handlers to be as simple as possible",
            "Designing signal handlers",
            "Some simple signal-handler designs:",
            "Set a global flag and return",
            "Main program periodically checks (and clears) flag, and takes",
            "appropriate action",
            "(See the discussion ofsig_atomic_tin TLPI§21.1.3)",
            "Signal handler does some clean-up and terminates process",
            "(TLPI§21.2)",
            "Signal handler performs a nonlocal goto to unwind stack",
            "sigsetjmp()andsiglongjmp()(TLPI§21.2.1)",
            "E.g., some shells do this when handling signals",
            "Signals are not queued",
            "Signals are not queued",
            "A blocked signal is marked just once as pending, even if",
            "generated multiple times",
            "⇒One signal may correspond to multiple “events”",
            "Must design programs that handle signals to allow for this",
            "Example:",
            "SIGCHLDis generated for parent when child terminates",
            "WhileSIGCHLDhandler executes,SIGCHLDis blocked",
            "Supposetwomore children terminate while handler executes",
            "Only oneSIGCHLDsignal will be queued",
            "Solution:SIGCHLDhandler should loop, checking if multiple",
            "children have terminated",
            "This page intentionally blank",
            "This page intentionally blank",
            "Linux System Programming Essentials",
            "Process Lifecycle",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Creating processes and executing programs",
            "Four key system calls (and their variants):",
            "fork(): create a new (“child”) process",
            "exit(): terminate calling process",
            "wait(): wait for a child process to terminate",
            "execve(): execute a new program in calling process",
            "[TLPI§24.1]",
            "Usingfork(),execve(),wait(), andexit()together",
            "Parent process",
            "running program A",
            "fork()",
            "Parent may perform",
            "other actions here",
            "wait(&wstatus)",
            "Execution of",
            "parent blocks",
            "Child process",
            "running program A",
            "execve(B, ...)",
            "Child process",
            "running program B",
            "exit(status)",
            "Memory of parent",
            "copied to child",
            "Kernel unblocks parent",
            "and deliversSIGCHLD",
            "Child status",
            "passed to parent",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Creating a new process:fork()",
            "Return value fromfork()",
            "Usingfork()",
            "Common idioms for usingfork():",
            "Outline"
          ],
          "codeExamples": [
            "#include<unistd.h>\npid_t fork(void);\nfork()creates a new process (“the child”)\nChild is anear exact duplicate of caller(“the parent”)\nNotionally, memory of parent is duplicated to create child\nIn practice, copy-on-write duplication is used\n⇒Only page tables must be duplicated at time offork()\nTwo processes share same (read-only) text segment\nTwo processes have separate copies of stack, data, and heap\nsegments\n⇒Each process can modify variables without affecting other\nprocess\n[TLPI§24.2]",
            "#include<unistd.h>\npid_t fork(void);\nBothprocesses continue execution by returning fromfork()\nfork()returns different values in parent and child:\nParent:\nOn success: PID of new child (allows parent to track child)\nOn failure: –1\nChild: returns 0\nChild can obtain its own PID usinggetpid()\nChild can obtain PID of parent usinggetppid()",
            "pid_t pid = fork();\nif(pid == -1) {\n/* Handle error */\n}else if(pid == 0) {\n/* Code executed by child */\n}else{\n/* Code executed by parent */\n}",
            "pid_t pid = fork();\nswitch(pid) {\ncase-1:\n/* Handle error */\nbreak;\ncase0:\n/* Code executed by child */\nbreak;\ndefault:\n/* Code executed by parent */\nbreak;\n}"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Exercise",
            "1",
            "Write a program that usesfork()to create a child process",
            "([template:procexec/ex.fork_var_test.c]). After thefork()call,",
            "both the parent and child should display their PIDs (getpid()). Include",
            "code to demonstrate that the child process created byfork()can modify",
            "its copy of a local variable inmain()without affecting the value in the",
            "parent’s copy of the variable.",
            "Note: you may find it useful to use thesleep(num-secs)library",
            "function to delay execution of the parent for a few seconds, to ensure",
            "that the child has a chance to execute before the parent inspects its",
            "copy of the variable.",
            "2",
            "Processes have many attributes. When a new process is created using",
            "fork(), which of those attributes are inherited by the child and which are",
            "not (e.g., are reset to some default)? Here, we explore whether two",
            "process attributes–signal dispositions and alarm timers–are inherited by",
            "a child process.",
            "[Exercise continues on the next slide]",
            "Exercise",
            "Write a program ([template:procexec/ex.inherit_alarm.c]) that",
            "performs the following steps in order to determine if a child process",
            "inherits signal dispositions and alarm timers from the parent:",
            "Establishes aSIGALRMhandler that prints the process’s PID.",
            "Starts an alarm timer that expires after two seconds. Do this using",
            "the callalarm(2). When the timer expires, it will notify by sending",
            "aSIGALRMsignal to the process.",
            "Creates a child process usingfork().",
            "After thefork(), the child fetches the disposition of theSIGALRM",
            "signal (sigaction()) and tests whether thesa_handlerfield in the",
            "returned structure is the address of the signal handler",
            "Both processes then loop 5 times, sleeping for half a second (use",
            "usleep()) and displaying the process PID. Which of the processes",
            "receives aSIGALRMsignal?",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Terminating a process",
            "A process can terminate itself using two APIs:",
            "_exit(2)(system call)",
            "exit(3)(library function)",
            "[TLPI§25.1]",
            "Terminating a process with_exit(2)",
            "Process exit status",
            "Terminating a process withexit(3)",
            "Most programs employexit(3), rather than_exit(2)",
            "Process teardown",
            "As part of process termination (normal or abnormal), the kernel",
            "performs various clean-ups:",
            "All openfile descriptorsare closed",
            "Associatedfile locksare released",
            "OpenPOSIX IPC objectsare closed (message queues,",
            "semaphores, shared memory)",
            "Memory mappingsare unmapped",
            "Memory locksare removed",
            "System V shared memory segmentsare detached",
            "And more...",
            "[TLPI§25.2]",
            "Outline"
          ],
          "codeExamples": [
            "#include<unistd.h>\nvoid_exit(intstatus);\n_exit()terminates the calling process\nAKAnormal termination\nabnormal termination== killed by a signal\n(In truth: on Linux,_exit()is a wrapper for Linux-specificexit_group(2),\nwhich terminates all threads in a process)",
            "#include<unistd.h>\nvoid_exit(intstatus);\nLeast significant 8 bits ofstatusdefineexit status\nRemaining bits ignored\n0 == success\nnonzero == failure\nPOSIX specifies two constants:\n#defineEXIT_SUCCESS 0\n#defineEXIT_FAILURE 1",
            "#include<stdlib.h>\nvoidexit(intstatus);\nTheexit(3)library function:\nCalls exit handlers registered by process (TLPI§25.3)\nExit handler == callback function automatically called at\nnormal process termination\natexit(3),on_exit(3)\nFlushesstdiobuffers\nCalls:_exit(status)\n(If we call_exit()directly, then exit handlers arenotcalled\nandstdiobuffers arenotflushed)\nreturn ninsidemain()is equivalent toexit(n)"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Overview",
            "Parent processes can use the “wait” family of APIs to",
            "monitor state change events in child processes:",
            "Termination",
            "Stop (because of a signal)",
            "Continue (afterSIGCONTsignal)",
            "Parent can obtain various info about state changes:",
            "Exit status of process",
            "What signal stopped or killed process",
            "Whether process produced a core dump before terminating",
            "For historical reasons, there are multiple “wait” functions",
            "Waiting for children withwaitpid()",
            "Waiting for children withwaitpid()",
            "Waiting for children withwaitpid()",
            "waitpid()example",
            "Wait for all children to terminate, and report their PIDs:",
            "for(;;) {",
            "childPid = waitpid(-1, NULL, 0);",
            "if(childPid == -1) {",
            "if(errno == ECHILD) {",
            "printf(\"No more children!\\n\");",
            "break;",
            "}else{            /* Unexpected error */",
            "errExit(\"waitpid\");",
            "}",
            "}",
            "printf(\"waitpid() returned PID %ld\\n\", (long) childPid);",
            "}",
            "The wait status value",
            "wstatusdistinguishes 4 types of event:",
            "Childterminated via_exit(), specifying anexit status",
            "Child waskilled by a signal",
            "Child wasstopped by a signal",
            "Child wascontinued by a signal",
            "The wait status value",
            "16 lowest bits ofwstatusreturned bywaitpid()encode status in",
            "such a way that the 4 cases can be distinguished:",
            "(Encoding is an implementation detail we don’t really need to care about)",
            "Dissecting the wait status",
            "<sys/wait.h>defines macros for dissecting a wait status",
            "Only one of the headline macros in this list will return true:",
            "1",
            "WIFEXITED(wstatus): true if child exited normally",
            "WEXITSTATUS(wstatus)returns exit status of child",
            "2",
            "WIFSIGNALED(wstatus): true if child was killed by signal",
            "WTERMSIG(wstatus)returns number of killing signal",
            "WCOREDUMP(wstatus)returns true if child dumped core",
            "3",
            "WIFSTOPPED(wstatus): true if child was stopped by signal",
            "WSTOPSIG(wstatus)returns number of stopping signal",
            "4",
            "WIFCONTINUED(wstatus): true if child was resumed by",
            "SIGCONT",
            "The subordinate macros may be used only if the",
            "corresponding headline macro tests true",
            "Example:procexec/print_wait_status.c",
            "Display wait status value in human-readable form",
            "voidprintWaitStatus(const char*msg,intstatus) {",
            "if(msg != NULL)",
            "printf(\"%s\", msg);",
            "if(WIFEXITED(status)) {",
            "printf(\"child exited, status=%d\\n\", WEXITSTATUS(status));",
            "}else if(WIFSIGNALED(status)) {",
            "printf(\"child killed by signal %d (%s)\",",
            "WTERMSIG(status), strsignal(WTERMSIG(status)));",
            "if(WCOREDUMP(status))",
            "printf(\" (core dumped)\");",
            "printf(\"\\n\");",
            "}else if(WIFSTOPPED(status)) {",
            "printf(\"child stopped by signal %d (%s)\\n\",",
            "WSTOPSIG(status), strsignal(WSTOPSIG(status)));",
            "}else if(WIFCONTINUED(status))",
            "printf(\"child continued\\n\");",
            "}",
            "An older wait API:wait()",
            "An newer wait API:waitid()",
            "Outline"
          ],
          "codeExamples": [
            "#include<sys/wait.h>\npid_t waitpid(pid_t pid,int*wstatus,intoptions);\nwaitpid()waits for a child process to change state\nNo child has changed state⇒call blocks\nChild has already changed state⇒call returns immediately\nwstatusargument returnswait statusvalue that describes\nchild state transition\nwstatuscan beNULL, if we don’t need this info\n(More details later)\nReturn value:\nOn success: PID of child whose status is being reported\nOn error, –1\nNo more children?⇒errnoset toECHILD\n[TLPI§26.1.2]",
            "#include<sys/wait.h>\npid_t waitpid(pid_t pid,int*wstatus,intoptions);\npidspecifies which child(ren) to wait for:\npid == –1:anychild of caller\npid > 0: child whosePIDequalspid\n(plus other possibilities, as documented in manual page)",
            "#include<sys/wait.h>\npid_t waitpid(pid_t pid,int*wstatus,intoptions);\nBy default,waitpid()reports onlyterminatedchildren\nTheoptionsbit mask can specify additional state changes to\nreport:\nWUNTRACED: reportstoppedchildren\nWCONTINUED: report stopped children that havecontinued\nSpecifyingWNOHANGinoptionscausesnonblockingwait\nIf no children have changed state,waitpid()returns\nimmediately, with return value of 0",
            "#include<sys/wait.h>\npid_t wait(int*wstatus);\nThe original “wait” API\nwait(&wstatus)==waitpid(-1, &wstatus, 0)\nStill commonly used to handle the simple, common case:\nwait for any child to terminate",
            "#include<sys/wait.h>\nintwaitid(idtype_t idtype, id_t id, siginfo_t *infop,intoptions);\nSimilar towaitpid(), but provides additional functionality,\nincluding:\nIndependently choose which events (termination / stopped /\ncontinued) to wait on\nwaitpid()always waits for at least termination events\nWait via PID file descriptor"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Orphans",
            "Anorphanis a process that lives longer than its parent",
            "Orphaned processes areadopted byinit",
            "initwaits for its adopted childrenwhen they terminate",
            "After orphan is adopted,getppid()returns PID ofinit",
            "Conventionally,inithas PID 1",
            "On systems where theinitsystem issystemd, then,",
            "depending on the configuration, things are different:",
            "A helper process (PID != 1) becomes parent of orphaned",
            "children",
            "When run with the--useroption,systemdorganizes all",
            "processes in the user’s session into a subtree with such a",
            "subreaper",
            "See discussion ofPR_SET_CHILD_SUBREAPERinprctl(2)",
            "[TLPI§26.2]",
            "Zombies",
            "Suppose achild terminates before parent waitsfor it",
            "Parent must still be able to collect status later",
            "⇒Child becomes azombie:",
            "Most process resources are recycled",
            "A process slot is retained",
            "PID, status, and resource usage statistics",
            "Zombie is removed when parent does a “wait”",
            "[TLPI§26.2]",
            "Creating a zombie:procexec/zombie.c",
            "Usage:zombie [num-zombies [sleep-secs]]",
            "1intmain(intargc,char*argv[]) {",
            "2intnzombies =  (argc > 1) ? atoi(argv[1]) : 1;",
            "3intsleepSecs = (argc > 2) ? atoi(argv[2]) : 0;",
            "4printf(\"Parent (PID %ld)\\n\", (long) getpid());",
            "5",
            "6for(intj = 0; j < nzombies; j++) {",
            "7switch(fork()) {",
            "8case-1:",
            "9errExit(\"fork-%d\", j);",
            "10case0:/* Child: exits to become zombie */",
            "11printf(\"Child  (PID %ld) exiting\\n\", (long) getpid());",
            "12if(sleepSecs > 0);",
            "13sleep(sleepSecs);",
            "14exit(EXIT_SUCCESS);",
            "15default:/* Parent continues in loop */",
            "16break;",
            "17}",
            "18}",
            "19sleep(3600);/* Children are zombies during this time */",
            "20while(wait(NULL) > 0)/* Reap zombie children */",
            "21continue;",
            "22exit(EXIT_SUCCESS);",
            "23 }",
            "Create one or more zombie child processes",
            "Creating a zombie:procexec/zombie.c",
            "1 $ ./zombie &",
            "2 [1] 23425",
            "5 $ ps -C zombie",
            "7 23425 pts/1    00:00:00 zombie",
            "8 23427 pts/1    00:00:00 zombie <defunct>",
            "9 $ kill-KILL23427",
            "10 $ ps -C zombie",
            "12 23425 pts/1    00:00:00 zombie",
            "13 23427 pts/1    00:00:00 zombie <defunct>",
            "Zombies can’t be killedby signals!",
            "(Since parent must still be able to “wait”)",
            "Even silver bullets (SIGKILL) don’t work",
            "Reap your zombies",
            "Zombie may live for ever, if parent fails to “wait” on it",
            "Or until parent is killed, so zombie is adopted byinit",
            "Long-lived processes that create children must ensure",
            "that zombies are “reaped”(“waited” for)",
            "Shells, network servers, ...",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 3,
      "title": "Parent (PID",
      "sections": []
    },
    {
      "number": 4,
      "title": "Child  (PID",
      "sections": []
    },
    {
      "number": 6,
      "title": "PID TTY          TIME CMD",
      "sections": []
    },
    {
      "number": 11,
      "title": "PID TTY          TIME CMD",
      "sections": []
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "API summary",
            "Outline"
          ],
          "codeExamples": [
            "pid_t fork(void);// Create a child process; returns\n// PID of child in parent, and 0 in child\nvoid_exit(intstatus);// Terminate process\nvoidexit(intstatus);// Call exit handlers, flush stdio, and\n// terminate process\n// Wait for (and return PID of) a child process:\npid_t waitpid(pid_t pid,int*wstatus,intoptions);\npid_t wait(int*wstatus);\n// Setting up handler for SIGCHLD:\nstructsigaction sa;\nsa.sa_handler = func;// Address of signal handler\nsa.sa_flags = 0;// Or possibly SA_RESTART\nsigemptyset(&sa.sa_mask);// Assuming we don't need to block any other\n// signals while handler runs\nsigaction(SIGCHLD, &sa, NULL);"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Exercise",
            "1",
            "Suppose that we have three processes related as grandparent (A),",
            "parent (B), and child (C), and that the parent exits after a few seconds,",
            "but the grandparent doesnotimmediately perform await()after the",
            "parent exits, with the result that the parent becomes a zombie, as in",
            "the following diagram.",
            "A",
            "fork()",
            "B",
            "fork()",
            "sleep(3)",
            "exit()1",
            "C",
            "sleep(6)",
            "waitpid(B)2",
            "Exercise",
            "When do you expect the child (C) to be adopted byinit(so thatgetppid()in the",
            "child returns 1): after the parent (B) terminates or after the grandparent (A) does a",
            "wait()? In other words, is the child adopted at point 1 or point 2 in the diagram?",
            "Write a program, [(minimal) template:procexec/ex.zombie_parent.c], to verify",
            "the answer.",
            "Note the following points:",
            "For a reminder of the usage offork(), see slide 6-9.",
            "You will need to use tosleep()in various parts of the program:",
            "The child (C) could loop 10 times, displaying the value returned by",
            "getppid()and sleeping for 1 second on each loop iteration.",
            "The parent (B) sleeps for 3 seconds before terminating.",
            "The grandparent (A) sleeps for 6 seconds before callingwaitpid()on the",
            "PID of the parent (B).",
            "Depending on your distribution (e.g., if you have asystemd-based system",
            "where the--userflag is employed), you may find that the orphaned child is",
            "reparented to a process other than PID 1. Find out what program is running in",
            "that process, by using the commandps <pid>.",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "TheSIGCHLDsignal",
            "SIGCHLDis generated for a parent when a child terminates",
            "Ignored by default",
            "CatchingSIGCHLDallows us to be asynchronously notified of",
            "child’s termination",
            "Can be more convenient than synchronous or nonblocking",
            "waitpid()calls",
            "WithinSIGCHLDhandler, we “wait” to reap zombie child",
            "[TLPI§26.3]",
            "ASIGCHLDhandler",
            "voidgrimReaper(intsig) {",
            "intsavedErrno = errno;",
            "while(waitpid(-1, NULL, WNOHANG) > 0)",
            "continue;",
            "errno = savedErrno;",
            "}",
            "Eachwaitpid()call reaps one terminated child",
            "whileloop handles possibility that multiple children terminated",
            "whileSIGCHLDwas blocked",
            "e.g., during earlier invocation of handler",
            "WNOHANG: don’t block if there are no more terminated children",
            "Loop terminates whenwaitpid()returns:",
            "0, meaning no moreterminatedchildren",
            "–1, probably witherrno == ECHILD, meaning no more children",
            "Save and restoreerrno, so that handler is reentrant (TLPI p427)",
            "SIGCHLDfor stopped and continued children",
            "SIGCHLDis also generated when a child stops or continues",
            "To prevent this, specifySA_NOCLDSTOPinsa_flagswhen",
            "establishingSIGCHLDhandler withsigaction()",
            "[TLPI§26.3.2]",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Executing a new program",
            "execve()loads a new program into calling process’s memory",
            "Old program, stack, data, and heap are discarded",
            "After executing run-time start-up code, execution commences",
            "in new program’smain()",
            "Various functions layered on top ofexecve():",
            "Provide variations on functionality ofexecve()",
            "Collectively termed “exec()”",
            "Seeexec(3)manual page",
            "[TLPI§27.1]",
            "Executing a new program withexecve()",
            "Executing a new program withexecve()",
            "Executing a new program withexecve()",
            "Executing a new program withexecve()",
            "Example:procexec/exec_status.c",
            "./exec_status command [args...]",
            "Create a child process",
            "Child executescommandwith supplied command-line",
            "arguments",
            "Parent waits for child to terminate, and reports wait status",
            "Example:procexec/exec_status.c",
            "1extern char**environ;",
            "2intmain(intargc,char*argv[]) {",
            "3     pid_t childPid, wpid;",
            "4intwstatus;",
            "5     ...",
            "6switch(childPid=fork()) {",
            "7case-1: errExit(\"fork\");",
            "8",
            "9case0:     /*Child*/",
            "10         printf(\"PID of child: %ld\\n\", (long) getpid());",
            "11char**nextArgv=&argv[1];         // argv for next program",
            "12char*progName=nextArgv[0];",
            "13         execve(progName,nextArgv,environ);",
            "14         errExit(\"execve\");",
            "15",
            "16default:    /*Parent*/",
            "17         wpid=waitpid(childPid,&wstatus,0);",
            "18if(wpid == -1) errExit(\"waitpid\");",
            "19         printf(\"Wait returned PID %ld\\n\", (long) wpid);",
            "20         printWaitStatus(\"\",wstatus);",
            "21     }",
            "22     exit(EXIT_SUCCESS);",
            "23 }",
            "Example:procexec/exec_status.c",
            "1 $ ./exec_status/bin/date",
            "5         childexited,status=0",
            "6 $ ./exec_status/bin/sleep60&",
            "7 [1] 4771",
            "9 $ kill4773",
            "11         childkilledbysignal15(Terminated)",
            "12 [1]+  Done          ./exec_status /bin/sleep 60",
            "Outline"
          ],
          "codeExamples": [
            "#include<unistd.h>\nintexecve(const char*pathname,char*constargv[],\nchar*constenvp[]);\nexecve()loads program atpathnameinto caller’s memory\npathnameis an absolute or relative pathname",
            "#include<unistd.h>\nintexecve(const char*pathname,char*constargv[],\nchar*constenvp[]);\nargvspecifies command-line arguments for new program\nDefinesargvargument formain()in new program\nNULL-terminated array of pointers to strings\nargv[0]is command name\nTypically, same as (basename part of)pathname\nProgram can vary its behavior, depending on value ofargv[0]\n(e.g.,busybox)\nSee example programs\nprocexec/launch_shell.c(“-” inargv[0][0]when execing\na shell triggers “login shell” behavior)\nprocexec/execve_argv_expt.c",
            "#include<unistd.h>\nintexecve(const char*pathname,char*constargv[],\nchar*constenvp[]);\nenvpspecifies environment list for new program\nDefinesenvironin new program\nNULL-terminated array of pointers to strings",
            "#include<unistd.h>\nintexecve(const char*pathname,char*constargv[],\nchar*constenvp[]);\nSuccessfulexecve()does not return\nIfexecve()returns, it failed; no need to check return value:\nexecve(pathname, argv, envp);\nperror(\"execve\");\nexit(EXIT_FAILURE);"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 2,
      "title": "PID of child:",
      "sections": []
    },
    {
      "number": 3,
      "title": "Thu Oct",
      "sections": []
    },
    {
      "number": 4,
      "title": "Wait returned PID",
      "sections": []
    },
    {
      "number": 8,
      "title": "PID of child:",
      "sections": []
    },
    {
      "number": 10,
      "title": "Wait returned PID",
      "sections": []
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Exercise",
            "1",
            "Write a simple shell program. The program should loop, continuously reading shell",
            "commands from standard input. Each input line consists of a set of white-space",
            "delimited words that are a command and its arguments. Each command should be",
            "executed in a new child process (fork()) usingexecve(). The parent process (the",
            "“shell”) should wait on each child and display its wait status (you can use the",
            "suppliedprintWaitStatus()function). [template:procexec/ex.simple_shell.c]",
            "Some hints:",
            "The space-delimited words in the input line need to be broken down into a set",
            "of null-terminated strings pointed to by anargv-style array, and that array",
            "must end with aNULLpointer. Thestrtok(3)library function simplifies this",
            "task. (This task is already performed by code in the template.)",
            "Becauseexecve()is used, you will need to type the full pathname when",
            "entering commands to your shell",
            "As a first test of you shell, try executing the following program (which is in the same",
            "directory):",
            "./show_argv a b c",
            "Fun facts: the source code ofbashis around 180k lines (dashis around 20k lines)",
            "Exercise",
            "2",
            "Write a program, ([template:procexec/ex.exec_self_pid.c]) that verifies that an",
            "exec does not change a process’s PID.",
            "The program should perform the following steps:",
            "Print the process’s PID.",
            "Ifargcis 2, the program exits.",
            "Otherwise, the program usesexecl()to re-execute itself with an",
            "additional command-line argument (any string), so thatargcwill be 2.",
            "Test the program by running it with no arguments (i.e.,argcis 1).",
            "3",
            "Write a program ([template:procexec/ex.make_link.c]) that takes 2 arguments:",
            "make_link target linkpath",
            "If invoked with the nameslink, it creates a symbolic link (symlink()) using these",
            "pathnames, otherwise it creates a hard link (link()). After compiling, create two hard",
            "links to the executable, with the nameshlinkandslink. Verify that when run with",
            "the namehlink, the program creates hard links, while when run with the nameslink,",
            "it creates symbolic links.",
            "Hint:",
            "You will find thebasename()andstrcmp()functions useful when inspecting",
            "the program name inargv[0].",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 6,
      "title": "Process Lifecycle",
      "sections": [
        {
          "id": "6.1",
          "title": "Introduction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.2",
          "title": "Creating a new process:fork()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.4",
          "title": "Process termination",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.5",
          "title": "Monitoring child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.6",
          "title": "Orphans and zombies",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.7",
          "title": "API summary",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.8",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.9",
          "title": "TheSIGCHLDsignal",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.10",
          "title": "Executing programs:execve()",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.11",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.12",
          "title": "Theexec()library functions",
          "content": [
            "Theexec()library functions",
            "Theexec()library functions",
            "Vary theme ofexecve()with 2 choices in each of 3 dimensions:",
            "How are command-line arguments of new program specified?",
            "How is the executable specified?",
            "How is environment of new program specified?",
            "Final letters in name of each function indicate behavior",
            "FunctionSpecification",
            "of arguments",
            "(v, l)",
            "Specification",
            "of executable",
            "file (-, p)",
            "Source of",
            "environment",
            "(e, -)",
            "execve()arraypathnameenvpargument",
            "execle()listpathnameenvpargument",
            "execlp()listfilename +PATHcaller’senviron",
            "execvp()arrayfilename +PATHcaller’senviron",
            "execv()arraypathnamecaller’senviron",
            "execl()listpathnamecaller’senviron",
            "execvpe()arrayfilename +PATHenvpargument",
            "Linux System Programming Essentials",
            "System Call Tracing withstrace",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [
            "#include<unistd.h>\nintexecle(const char*pathname,const char*arg, ...\n/* , (char *) NULL, char *const envp[] */ );\nintexeclp(const char*filename,const char*arg, ...\n/* , (char *) NULL */);\nintexecvp(const char*filename,char*constargv[]);\nintexecv(const char*pathname,char*constargv[]);\nintexecl(const char*pathname,const char*arg, ...\n/* , (char *) NULL */);\nintexecvpe(const char*filename,const*charargv[],\nchar*constenvp[]);\nVariations on theme ofexecve()\nLikeexecve(), theexec()functions return only if they fail\nexecvpe()is Linux-specific (define_GNU_SOURCE)"
          ],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [
            "strace(1)",
            "A tool to trace system calls made by a user-space process",
            "Implemented viaptrace(2)",
            "https://strace.io/",
            "Or: a debugging tool for tracingcomplete conversation",
            "between application and kernel",
            "Application source code is not required",
            "Answer questions like:",
            "What system calls are employed by application?",
            "Which files does application touch?",
            "What arguments are being passed to each system call?",
            "Which system calls are failing, and why (errno)?",
            "See also the loosely relatedltrace(1)command",
            "Trace function calls in shared libraries (e.g., libc)",
            "strace(1)",
            "Trace information is provided insymbolic form",
            "System call namesare shown",
            "We seesignal names(not numbers)",
            "Stringsprinted as characters (up to 32 bytes, by default)",
            "Bit-mask arguments displayed symbolically, using",
            "corresponding bit flag names ORed together",
            "Structuresdisplayed withlabeled fields",
            "“Large” arguments are abbreviated by default",
            "Usestrace –v(verbose) to see unabbreviated arguments",
            "strace(1)",
            "fstat(3, {st_dev=makedev(0x8, 0x5), st_ino=407279,",
            "st_mode=S_IFREG|0755, st_nlink=1, st_uid=0, st_gid=0,",
            "st_blksize=4096, st_blocks=80, st_size=36960, st_atime=1625615479",
            "/* 2021-07-07T01:51:19.795021222+0200 */, st_atime_nsec=795021222,",
            "st_mtime=1613345143 /* 2021-02-15T00:25:43+0100 */, st_mtime_nsec=0,",
            "st_ctime=1616161103 /* 2021-03-19T14:38:23.816838407+0100 */,",
            "st_ctime_nsec=816838407}) = 0",
            "open(\"/lib64/liblzma.so.5\", O_RDONLY|O_CLOEXEC) = 3",
            "access(\"/etc/ld.so.preload\", R_OK)      = -1 ENOENT(Nosuchfileor",
            "directory)",
            "For each system call, we see:",
            "Name of system call",
            "Values passed in/returned via arguments",
            "System call return value",
            "Symbolicerrnovalue (+ explanatory text) on syscall failures",
            "Simple usage: tracing a command at the command line",
            "A very simple C program:",
            "intmain(intargc,char*argv[]) {",
            "#defineSTR \"Hello world\\n\"",
            "write(STDOUT_FILENO, STR, strlen(STR));",
            "exit(EXIT_SUCCESS);",
            "}",
            "Runstrace(1), directing logging output (–o) to a file:",
            "$ strace -o strace.log ./hello_world",
            "Hello world",
            "(By default, trace output goes to standard error)",
            "\"",
            "On some systems, may first need to to ensure",
            "ptrace_scopefile has value 0 or 1:",
            "$ sudo sh -c'echo 0 > /proc/sys/kernel/yama/ptrace_scope'",
            "Yama LSM disablesptrace(2)to prevent attack escalation;",
            "seeptrace(2)manual page",
            "Simple usage: tracing a command at the command line",
            "$ cat strace.log",
            "execve(\"./hello_world\", [\"./hello_world\"], [/* 110 vars */]) = 0",
            "...",
            "access(\"/etc/ld.so.preload\", R_OK)= -1 ENOENT (No such file or directory)",
            "open(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 3",
            "fstat(3, {st_mode=S_IFREG|0644, st_size=160311, ...}) = 0",
            "mmap(NULL, 160311, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fa5ecfc0000",
            "close(3)= 0",
            "open(\"/lib64/libc.so.6\", O_RDONLY|O_CLOEXEC) = 3",
            "...",
            "write(1, \"Hello world\\n\", 12)= 12",
            "exit_group(0)= ?",
            "+++ exited with 0 +++",
            "Even simple programs make lots of system calls!",
            "25 in this case (many have been edited from above output)",
            "Most output in this trace relates to finding and loading",
            "shared libraries",
            "First call (execve()) was used by shell to load our program",
            "Only last two system calls were made by our program",
            "A gotcha...",
            "The last call in our program was:",
            "exit(EXIT_SUCCESS);",
            "Butstraceshowed us:",
            "exit_group(0)                           = ?",
            "Some detective work:",
            "We “know”exit(3)is a library function that calls_exit(2)",
            "But where didexit_group()come from?",
            "_exit(2)manual page tells us:",
            "$ man 2 _exit",
            "...",
            "Clibrary/kerneldifferences",
            "In glibc up to version 2.3, the _exit() wrapper function",
            "invoked  the kernel system call of the same name.  Since",
            "glibc 2.3, the wrapper function  invokes  exit_group(2),",
            "in order to terminate all of the threads in a process.",
            "⇒may need to dig deeper to understandstrace(1)output",
            "Tracing live processes",
            "–p PID:trace running processwith specified PID",
            "TypeControl-Cto cease tracing",
            "Totrace multiple processes, specify–pmultiple times",
            "Can trace only processes you own",
            "(And a process can have only one tracer)",
            "\"\"",
            "tracing a process canheavily affect performance",
            "E.g., up to two orders of magnitude slow-down in syscalls",
            "\"",
            "Think twice before using in a production environment",
            "–p PID –f: willtrace all threadsin specified process",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [
            "Tracing child processes",
            "By default,stracedoes not trace children of traced process",
            "–foption causes children to be traced",
            "Each trace line is prefixed by PID",
            "In a program that employs POSIX threads, each line shows",
            "kernel thread ID (gettid())",
            "Tracing child processes:strace/fork_exec.c",
            "1intmain(intargc,char*argv[]) {",
            "2     pid_t childPid;",
            "3char*newEnv[] = {\"ONE=1\", \"TWO=2\", NULL};",
            "4",
            "5     printf(\"PID of parent: %ld\\n\", (long) getpid());",
            "6     childPid = fork();",
            "7if(childPid == 0) {        /* Child */",
            "8         printf(\"PID of child:  %ld\\n\", (long) getpid());",
            "9if(argc > 1) {",
            "10             execve(argv[1], &argv[1], newEnv);",
            "11             errExit(\"execve\");",
            "12         }",
            "13         exit(EXIT_SUCCESS);",
            "14     }",
            "15     wait(NULL);         /* Parent waits for child */",
            "16     exit(EXIT_SUCCESS);",
            "17 }",
            "$ strace -f -o strace.log ./fork_exec",
            "PID of parent: 1939",
            "PID of child:  1940",
            "Tracing child processes:strace/fork_exec.c",
            "$ cat strace.log",
            "1939 execve(\"./fork_exec\", [\"./fork_exec\"], [/* 110 vars */]) = 0",
            "...",
            "1939 clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD,",
            "child_tidptr=0x7fe484b2ea10) = 1940",
            "1939 wait4(-1,  <unfinished...>",
            "1940 write(1, \"PID of child:  1940\\n\", 21) = 21",
            "1940 exit_group(0)= ?",
            "1940 +++ exited with 0 +++",
            "1939 <... wait4resumed> NULL, 0, NULL) = 1940",
            "1939 --- SIGCHLD{si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=1940,",
            "si_uid=1000, si_status=0, si_utime=0, si_stime=0} ---",
            "1939 exit_group(0)= ?",
            "1939 +++ exited with 0 +++",
            "Each line of trace output is prefixed with corresponding PID",
            "Inside glibc,fork()is actually a wrapper that callsclone(2)",
            "wait()is a wrapper that callswait4(2)",
            "We see two lines of output forwait4()because call blocks",
            "and then resumes",
            "straceshows us that parent received aSIGCHLDsignal",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [
            "Exercises",
            "1",
            "Try usingstraceto trace the execution of a program of your",
            "choice.",
            "2",
            "Some amusements (may require the value 0 in",
            "/proc/sys/kernel/yama/ptrace_scope):",
            "strace -p $$",
            "strace strace -p $$",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [
            "Selecting system calls to be traced",
            "strace –ecan be used to select system calls to be traced",
            "–e trace=<syscall>[,<syscall>...]",
            "Specify system call(s) that should be traced",
            "Other system calls are ignored",
            "$ strace -o strace.log -e trace=open,close ls",
            "–e trace=!<syscall>[,<syscall>...]",
            "Excludespecified system call(s) from tracing",
            "Some applications do bizarre things (e.g., calling",
            "gettimeofday()1000s of times/sec.)",
            "\"",
            "“!” needs to be quoted to avoid shell interpretation",
            "–e trace=/<regexp>",
            "Trace syscalls whose names match regular expression",
            "April 2017; expression will probably need to be quoted...",
            "Selecting system calls by category",
            "–e trace=<syscall-category>trace a category of syscalls",
            "Categories include:",
            "%file: trace all syscalls that take a filename as argument",
            "open(),stat(),truncate(),chmod(),setxattr(),link()...",
            "%desc: trace file-descriptor-related syscalls",
            "read(),write(),open(),close(),fsetxattr(),poll(),select(),",
            "pipe(),fcntl(),epoll_create(),epoll_wait()...",
            "%process: trace process management syscalls",
            "fork(),clone(),exit_group(),execve(),wait4(),unshare()...",
            "%network: trace network-related syscalls",
            "socket(),bind(),listen(),connect(),sendmsg()...",
            "%signal: trace signal-related syscalls",
            "kill(),rt_sigaction(),rt_sigprocmask(),rt_sigqueueinfo()...",
            "%memory: trace memory-mapping-related syscalls",
            "mmap(),mprotect(),mlock()...",
            "Filtering signals",
            "strace –e signal=set",
            "Trace only specified set of signals",
            "“sig” prefix in names is optional; following are equivalent:",
            "$ strace -e signal=sigio,sigintls > /dev/null",
            "$ strace -e signal=io,intls > /dev/null",
            "strace –e signal=!set",
            "Exclude specified signals from tracing",
            "Filtering by pathname",
            "strace –P pathname: trace only system calls that access file",
            "atpathname",
            "Specify multiple–Poptions to trace multiple paths",
            "Example:",
            "$ strace -o strace.log -P /lib64/libc.so.6 ls > /dev/null",
            "Requested path'/lib64/libc.so.6'resolved into'/usr/lib64/libc-2.18.so'",
            "$ cat strace.log",
            "open(\"/lib64/libc.so.6\", O_RDONLY|O_CLOEXEC) = 3",
            "read(3, \"\\177ELF\\2\\1\\1\\3\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0>\\0\\1\\0\\0\\0p\\36\\2\\0\\0\\0\\0\\0\"...,",
            "832) = 832",
            "fstat(3, {st_mode=S_IFREG|0755, st_size=2093096, ...}) = 0",
            "mmap(NULL, 3920480, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE,",
            "3, 0) = 0x7f8511fa3000",
            "mmap(0x7f8512356000, 24576, PROT_READ|PROT_WRITE,",
            "MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1b3000) = 0x7f8512356000",
            "close(3)= 0",
            "+++ exited with 0 +++",
            "stracenoticed that the specified file was opened on FD 3,",
            "and also traced operations on that FD",
            "Mapping file descriptors to pathnames",
            "–yoption causesstraceto display pathnames corresponding",
            "to each file descriptor",
            "Useful info is also displayed for other types of file descriptors,",
            "such as pipes and sockets",
            "$ strace -y cat greet",
            "...",
            "openat(AT_FDCWD, \"greet\", O_RDONLY)    = 3</home/mtk/greet>",
            "fstat(3</home/mtk/greet>, {st_mode=S_IFREG|0644, ...",
            "read(3</home/mtk/greet>, \"hello world\\n\", 131072) = 12",
            "write(1</dev/pts/11>, \"hello world\\n\", 12) = 12",
            "read(3</home/mtk/greet>, \"\", 131072) = 0",
            "close(3</home/mtk/greet>)    = 0",
            "...",
            "–yyis as for–ybut shows additional protocol-specific info for",
            "sockets",
            "write(3<TCP:[10.0.20.135:33522->213.131.240.174:80]>,",
            "\"GET / HTTP/1.1\\r\\nUser-Agent: Wget\"..., 135) = 135",
            "read(3<TCP:[10.0.20.135:33522->213.131.240.174:80]>,",
            "\"HTTP/1.1 200 OK\\r\\nDate: Thu, 19 J\"..., 253) = 253",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [
            "System call tampering",
            "stracecan be used tomodifybehavior of selected syscall(s)",
            "Initial feature implementation completed in early 2017",
            "Various possible effects:",
            "Inject delay before/after syscall",
            "Generate a signal on syscall",
            "Bypass execution of syscall, making it return a “success”",
            "value or fail with specified value inerrno(error injection)",
            "(Limited) ability to choose which invocation of syscall will be",
            "modified",
            "strace -e injectoptions",
            "Syntax:strace -e inject=<syscall-set>[:<option>]...",
            "syscall-setis set of syscalls whose behavior will be modified",
            ":error=errnum: syscall is not executed; returns failure",
            "status witherrnoset as specified",
            ":retval=value: syscall is not executed; returns specified",
            "“success” value",
            "Can’t specify both:retvaland:errortogether",
            "strace -e injectoptions",
            ":signal=sig: deliver specified signal on entry to syscall",
            ":delay_enter=usecs,:delay_exit=usecs: delay forusecs",
            "microseconds on entry to/return from syscall",
            ":when=expr: specify which invocation(s) to tamper with",
            ":when=N: tamper with invocationN",
            ":when=N+: tamper starting atNth invocation",
            ":when=N+S: tamper with invocationN, and then everyS",
            "invocations",
            "Range ofNandSis 1..65535",
            "Example",
            "$ strace -y-e close -einject=close:error=22:when=3/bin/ls > d",
            "close(3</etc/ld.so.cache>)= 0",
            "close(3</usr/lib64/libselinux.so.1>)   = 0",
            "close(3</usr/lib64/libcap.so.2.25>)    =  -1EINVAL(Invalidargument)(INJECTED)",
            "close(3</usr/lib64/libcap.so.2.25>)    = 0",
            "/bin/ls: errorwhileloading shared libraries: libcap.so.2:",
            "cannot close file descriptor: Invalid argument",
            "+++ exited with 127 +++",
            "Use–yto show pathnames corresponding to file descriptors",
            "Inject error 22 (EINVAL) on third call toclose()",
            "Thirdclose()was not executed; an error return was injected",
            "(After that,lsgot sad)",
            "Using system call tampering for error injection",
            "Success-injection example: makeunlinkat()succeed, without",
            "deleting temporary file that would have been deleted",
            "Error-injection use case: quick and simple black-box testing",
            "Does application fail gracefully when encountering",
            "unexpected error?",
            "But there are alternatives for black-box testing:",
            "Preloaded library with interposing wrapper function that",
            "spoofs a failure (without calling “real” function)",
            "Can be more flexible",
            "But can’t be used with set-UID/set-GID programs",
            "Seccomp (secure computing)",
            "Generalized facility to block execution of system calls based",
            "on system call number and argument values",
            "More powerful, but can’t, for example cause Nth call to fail",
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 7,
      "title": "System Call Tracing withstrace",
      "sections": [
        {
          "id": "7.1",
          "title": "Getting started",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.2",
          "title": "Tracing child processes",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.3",
          "title": "Exercises",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.4",
          "title": "Filteringstraceoutput",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.5",
          "title": "System call tampering",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.6",
          "title": "Furtherstraceoptions",
          "content": [
            "Obtaining a system call summary",
            "strace –ccounts time, calls, and errors for each system call",
            "and reports a summary on program exit",
            "$ strace -c who > /dev/null",
            "% time     seconds  usecs/call     calls    errors syscall",
            "------ ----------- ----------- --------- --------- --------------"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "21.77",
          "title": "0.000648           9        72           alarm",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "14.42",
          "title": "0.000429           9        48           rt_sigaction",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "13.34",
          "title": "0.000397           8        48           fcntl",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "8.84",
          "title": "0.000263           5        48           read",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "7.29",
          "title": "0.000217          13        17         2 kill",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "6.79",
          "title": "0.000202           6        33         1 stat",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "5.41",
          "title": "0.000161           5        31           mmap",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "4.44",
          "title": "0.000132           4        31         6 open",
          "content": [],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "2.89",
          "title": "0.000086           3        29           close",
          "content": [
            "...",
            "------ ----------- ----------- --------- --------- --------------"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        },
        {
          "id": "100.00",
          "title": "0.002976                   442        13 total",
          "content": [
            "Treat time measurements as indicative only, sincestraceadds",
            "overhead to each syscall",
            "Furtherstraceoptions",
            "–k: print a stack trace after each traced syscall",
            "sudo strace –u <username> prog: run program with UID",
            "and GIDs of specified user",
            "Useful when tracing privileged programs, such as",
            "set-UID-rootprograms",
            "Normally, privileged programs arenotrun with privilege when",
            "executed understrace",
            "Furtherstraceoptions",
            "–v: don’t abbreviate arguments (structures, etc.)",
            "Output can be quite verbose...",
            "–s strsize: maximum number of bytes to display for strings",
            "Default is 32 characters",
            "Pathnames are always printed in full",
            "Various options show start time or duration of system calls",
            "–t,–tt: prefix each trace line with wall-clock time",
            "–ttalso adds microseconds",
            "–T: show time spent in syscall",
            "But treat as indications only, sincestracecauses overhead on",
            "syscalls",
            "Linux System Programming Essentials",
            "Wrapup",
            "August 2025",
            "mtk@man7.org",
            "OutlineRev: # caf166f4161b"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 8,
      "title": "Wrapup",
      "sections": [
        {
          "id": "8.1",
          "title": "Wrapup",
          "content": [
            "Outline"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    },
    {
      "number": 8,
      "title": "Wrapup",
      "sections": [
        {
          "id": "8.1",
          "title": "Wrapup",
          "content": [
            "Course materials",
            "I’m the (sole) producer of the course book and example",
            "programs",
            "Course materials are continuously revised",
            "Send corrections and suggestions for improvements to",
            "mtk@man7.org",
            "Marketing",
            "Independent trainer, consultant, and writer",
            "Author ofThe Linux Programming Interface",
            "Reputation / word-of-mouth are important for my business...",
            "Let people know about these courses!",
            "Linux/UNIX system programming",
            "Linux security and isolation APIs",
            "Namespaces, cgroups, seccomp, and capabilities",
            "System programming for Linux containers",
            "Building and using shared libraries",
            "Linux/UNIX network programming",
            "TCP/IP fundamentals",
            "Subsets/combinations of the above;see next slide",
            "Further courses to be announced:http://man7.org/training/",
            "Course overview (seehttps://man7.org/training)",
            "Linux/UNIX System Programming(LUSP01, 5 days)",
            "System Programming Fundamentals",
            "(SPINTRO01, 2 days)",
            "Threads and IPC Programming",
            "(TIPC01, 3 days)",
            "IPC Programming",
            "(IPC02, 3 days)",
            "POSIX Threads",
            "(PTHR01, 1 day)",
            "System Programming for Linux Containers(SPLC02, 5 days)",
            "Linux Security and Isolation APIs(SECISOL02, 4 days)",
            "Capabilities + Namespaces",
            "(CAPNS01, 2 days)",
            "Seccomp",
            "(SECCOMP01, 1d)",
            "Control Groups",
            "(CGROUPS02, 1d)",
            "System Prog.",
            "Essentials",
            "(SPESS01, 1d)",
            "Linux/UNIX Network",
            "Prog.(NWP03, 3 days)",
            "TCP/IP Fundamentals",
            "(TCPIP01, 1 day)",
            "Linux Shared Libraries",
            "(SHLIB04, 2.5 days)",
            "Nesting indicates a topic that can be taken either as a",
            "separate course or as part of a longer course",
            "Arrows show a suggested prerequisite course",
            "Thanks!",
            "mtk@man7.org   @mkerrisk   linkedin.com/in/mkerrisk",
            "PGP fingerprint: 4096R/3A35CE5E",
            "http://man7.org/training/",
            "(New Zealand Little Blue Penguins)",
            "This page intentionally blank"
          ],
          "codeExamples": [],
          "apiSignatures": [],
          "keyPoints": []
        }
      ]
    }
  ],
  "knowledgeGraph": {
    "nodes": [
      {
        "id": "open",
        "type": "syscall",
        "chapter": 3,
        "category": "file_io",
        "manSection": 2
      },
      {
        "id": "close",
        "type": "syscall",
        "chapter": 3,
        "category": "file_io",
        "manSection": 2
      },
      {
        "id": "read",
        "type": "syscall",
        "chapter": 3,
        "category": "file_io",
        "manSection": 2
      },
      {
        "id": "write",
        "type": "syscall",
        "chapter": 3,
        "category": "file_io",
        "manSection": 2
      },
      {
        "id": "fork",
        "type": "syscall",
        "chapter": 6,
        "category": "process",
        "manSection": 2
      },
      {
        "id": "exec",
        "type": "syscall",
        "chapter": 6,
        "category": "process",
        "manSection": 2
      },
      {
        "id": "wait",
        "type": "syscall",
        "chapter": 6,
        "category": "process",
        "manSection": 2
      },
      {
        "id": "waitpid",
        "type": "syscall",
        "chapter": 6,
        "category": "process",
        "manSection": 2
      },
      {
        "id": "exit",
        "type": "syscall",
        "chapter": 6,
        "category": "process",
        "manSection": 2
      },
      {
        "id": "sigaction",
        "type": "syscall",
        "chapter": 5,
        "category": "signals",
        "manSection": 2
      },
      {
        "id": "sigprocmask",
        "type": "syscall",
        "chapter": 5,
        "category": "signals",
        "manSection": 2
      },
      {
        "id": "kill",
        "type": "syscall",
        "chapter": 5,
        "category": "signals",
        "manSection": 2
      },
      {
        "id": "getpid",
        "type": "syscall",
        "chapter": 4,
        "category": "process",
        "manSection": 2
      },
      {
        "id": "getppid",
        "type": "syscall",
        "chapter": 4,
        "category": "process",
        "manSection": 2
      },
      {
        "id": "file_descriptor",
        "type": "concept",
        "chapter": 3
      },
      {
        "id": "process",
        "type": "concept",
        "chapter": 4
      },
      {
        "id": "signal",
        "type": "concept",
        "chapter": 5
      },
      {
        "id": "errno",
        "type": "concept",
        "chapter": 2
      },
      {
        "id": "zombie",
        "type": "concept",
        "chapter": 6
      },
      {
        "id": "orphan",
        "type": "concept",
        "chapter": 6
      }
    ],
    "edges": [
      {
        "source": "open",
        "target": "close",
        "type": "related"
      },
      {
        "source": "open",
        "target": "read",
        "type": "related"
      },
      {
        "source": "open",
        "target": "write",
        "type": "related"
      },
      {
        "source": "open",
        "target": "fcntl",
        "type": "related"
      },
      {
        "source": "close",
        "target": "open",
        "type": "related"
      },
      {
        "source": "close",
        "target": "dup",
        "type": "related"
      },
      {
        "source": "close",
        "target": "dup2",
        "type": "related"
      },
      {
        "source": "read",
        "target": "write",
        "type": "related"
      },
      {
        "source": "read",
        "target": "open",
        "type": "related"
      },
      {
        "source": "read",
        "target": "lseek",
        "type": "related"
      },
      {
        "source": "write",
        "target": "read",
        "type": "related"
      },
      {
        "source": "write",
        "target": "open",
        "type": "related"
      },
      {
        "source": "write",
        "target": "fsync",
        "type": "related"
      },
      {
        "source": "fork",
        "target": "exec",
        "type": "related"
      },
      {
        "source": "fork",
        "target": "wait",
        "type": "related"
      },
      {
        "source": "fork",
        "target": "exit",
        "type": "related"
      },
      {
        "source": "fork",
        "target": "clone",
        "type": "related"
      },
      {
        "source": "exec",
        "target": "fork",
        "type": "related"
      },
      {
        "source": "exec",
        "target": "execve",
        "type": "related"
      },
      {
        "source": "exec",
        "target": "execl",
        "type": "related"
      },
      {
        "source": "exec",
        "target": "execv",
        "type": "related"
      },
      {
        "source": "wait",
        "target": "waitpid",
        "type": "related"
      },
      {
        "source": "wait",
        "target": "fork",
        "type": "related"
      },
      {
        "source": "wait",
        "target": "SIGCHLD",
        "type": "related"
      },
      {
        "source": "waitpid",
        "target": "wait",
        "type": "related"
      },
      {
        "source": "waitpid",
        "target": "WNOHANG",
        "type": "related"
      },
      {
        "source": "waitpid",
        "target": "WUNTRACED",
        "type": "related"
      },
      {
        "source": "exit",
        "target": "_exit",
        "type": "related"
      },
      {
        "source": "exit",
        "target": "atexit",
        "type": "related"
      },
      {
        "source": "exit",
        "target": "fork",
        "type": "related"
      },
      {
        "source": "sigaction",
        "target": "signal",
        "type": "related"
      },
      {
        "source": "sigaction",
        "target": "sigprocmask",
        "type": "related"
      },
      {
        "source": "sigaction",
        "target": "sigemptyset",
        "type": "related"
      },
      {
        "source": "sigprocmask",
        "target": "sigaction",
        "type": "related"
      },
      {
        "source": "sigprocmask",
        "target": "sigpending",
        "type": "related"
      },
      {
        "source": "sigprocmask",
        "target": "sigsuspend",
        "type": "related"
      },
      {
        "source": "kill",
        "target": "sigaction",
        "type": "related"
      },
      {
        "source": "kill",
        "target": "raise",
        "type": "related"
      },
      {
        "source": "kill",
        "target": "SIGTERM",
        "type": "related"
      },
      {
        "source": "getpid",
        "target": "getppid",
        "type": "related"
      },
      {
        "source": "getpid",
        "target": "fork",
        "type": "related"
      },
      {
        "source": "getppid",
        "target": "getpid",
        "type": "related"
      },
      {
        "source": "getppid",
        "target": "fork",
        "type": "related"
      }
    ],
    "concepts": {
      "file_descriptor": {
        "id": "file_descriptor",
        "chapter": 3,
        "related": [
          "open",
          "close",
          "read",
          "write"
        ]
      },
      "process": {
        "id": "process",
        "chapter": 4,
        "related": [
          "fork",
          "exec",
          "wait",
          "getpid"
        ]
      },
      "signal": {
        "id": "signal",
        "chapter": 5,
        "related": [
          "sigaction",
          "kill",
          "sigprocmask"
        ]
      },
      "errno": {
        "id": "errno",
        "chapter": 2,
        "related": [
          "perror",
          "strerror"
        ]
      },
      "zombie": {
        "id": "zombie",
        "chapter": 6,
        "related": [
          "wait",
          "SIGCHLD",
          "fork"
        ]
      },
      "orphan": {
        "id": "orphan",
        "chapter": 6,
        "related": [
          "init",
          "getppid"
        ]
      }
    },
    "apiIndex": {
      "open": {
        "chapter": 3,
        "related": [
          "close",
          "read",
          "write",
          "fcntl"
        ],
        "category": "file_io"
      },
      "close": {
        "chapter": 3,
        "related": [
          "open",
          "dup",
          "dup2"
        ],
        "category": "file_io"
      },
      "read": {
        "chapter": 3,
        "related": [
          "write",
          "open",
          "lseek"
        ],
        "category": "file_io"
      },
      "write": {
        "chapter": 3,
        "related": [
          "read",
          "open",
          "fsync"
        ],
        "category": "file_io"
      },
      "fork": {
        "chapter": 6,
        "related": [
          "exec",
          "wait",
          "exit",
          "clone"
        ],
        "category": "process"
      },
      "exec": {
        "chapter": 6,
        "related": [
          "fork",
          "execve",
          "execl",
          "execv"
        ],
        "category": "process"
      },
      "wait": {
        "chapter": 6,
        "related": [
          "waitpid",
          "fork",
          "SIGCHLD"
        ],
        "category": "process"
      },
      "waitpid": {
        "chapter": 6,
        "related": [
          "wait",
          "WNOHANG",
          "WUNTRACED"
        ],
        "category": "process"
      },
      "exit": {
        "chapter": 6,
        "related": [
          "_exit",
          "atexit",
          "fork"
        ],
        "category": "process"
      },
      "sigaction": {
        "chapter": 5,
        "related": [
          "signal",
          "sigprocmask",
          "sigemptyset"
        ],
        "category": "signals"
      },
      "sigprocmask": {
        "chapter": 5,
        "related": [
          "sigaction",
          "sigpending",
          "sigsuspend"
        ],
        "category": "signals"
      },
      "kill": {
        "chapter": 5,
        "related": [
          "sigaction",
          "raise",
          "SIGTERM"
        ],
        "category": "signals"
      },
      "getpid": {
        "chapter": 4,
        "related": [
          "getppid",
          "fork"
        ],
        "category": "process"
      },
      "getppid": {
        "chapter": 4,
        "related": [
          "getpid",
          "fork"
        ],
        "category": "process"
      }
    },
    "exerciseIndex": []
  },
  "learningPaths": {
    "beginner": [
      "2.1",
      "3.1",
      "3.2",
      "4.1",
      "4.2"
    ],
    "intermediate": [
      "5.1",
      "5.2",
      "5.4",
      "6.1",
      "6.2",
      "6.5"
    ],
    "advanced": [
      "5.6",
      "5.10",
      "6.9",
      "6.10",
      "7.1",
      "7.4",
      "7.5"
    ]
  },
  "prerequisites": {
    "3": [
      "C programming",
      "Basic Linux commands"
    ],
    "4": [
      "Chapter 3 concepts"
    ],
    "5": [
      "Chapter 4 concepts"
    ],
    "6": [
      "Chapter 4 and 5 concepts"
    ],
    "7": [
      "All previous chapters"
    ]
  }
}